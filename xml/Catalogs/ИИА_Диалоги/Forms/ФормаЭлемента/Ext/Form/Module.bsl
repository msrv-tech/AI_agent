&НаСервере
Процедура ПриСозданииНаСервере(Отказ, СтандартнаяОбработка)
	
	ЛогСсылка = "Лог";
	
	// Загружаем ОркестраторВключен из регистра сведений
	Если ЗначениеЗаполнено(Объект.Ссылка) Тогда
		ОркестраторВключен = ИИА_Сервер.ОркестраторВключенДляДиалога(Объект.Ссылка);
	Иначе
		ОркестраторВключен = Ложь;
	КонецЕсли;
	
КонецПроцедуры

&НаКлиенте
Процедура ЛогСсылкаНажатие(Элемент, СтандартнаяОбработка)
	
	СтандартнаяОбработка = Ложь;
	
	Если Объект.Ссылка.Пустая() Тогда
		Сообщить("Диалог еще не сохранен.");
		Возврат;
	КонецЕсли;
	
	// Принудительно загружаем актуальный лог из справочника
	ТекстЛога = ИИА_ВызовСервера.ПолучитьЛогДиалога(Объект.Ссылка);
	
	// Если лог пустой, проверим, может это новый диалог без лога или ошибка
	Если ПустаяСтрока(ТекстЛога) Тогда
		ОписаниеДиалога = ИИА_ВызовСервера.ПолучитьОписаниеДиалога(Объект.Ссылка);
		Сообщить("Лог диалога пуст. Текущий диалог: " + Строка(Объект.Ссылка.УникальныйИдентификатор()) + " | " + ОписаниеДиалога);
		Возврат;
	КонецЕсли;
	
	ТекстовыйДокумент = Новый ТекстовыйДокумент;
	ТекстовыйДокумент.УстановитьТекст(ТекстЛога);
	ТекстовыйДокумент.Показать("Лог диалога: " + Строка(Объект.Ссылка));
	
КонецПроцедуры
