#Область ПрограммныйИнтерфейс

// Получает список всех справочников конфигурации
//
// Параметры:
//  Фильтр - Строка - (опционально) подстрока для поиска в имени или синониме
//
// Возвращаемое значение:
//  Массив - массив структур с информацией о справочниках:
//   * Имя - Строка - имя справочника (полное, для GetObjectFields/RunQuery)
//   * ПолноеИмя - Строка - полное имя вида "Справочник.Имя"
//   * Синоним - Строка - синоним справочника
//
Функция ПолучитьСписокСправочников(Фильтр = "") Экспорт
	
	Результат = Новый Массив;
	ФильтрВРег = ВРег(Фильтр);
	
	// АВТО-РАСШИРЕНИЕ ФИЛЬТРА (если ничего не найдено по точному вхождению)
	МассивФильтров = Новый Массив;
	МассивФильтров.Добавить(ФильтрВРег);
	
	Если НЕ ПустаяСтрока(Фильтр) Тогда
		Похожие = НайтиПохожиеОбъекты(Фильтр, "Справочник");
		Для Каждого Похожий Из Похожие Цикл
			МассивФильтров.Добавить(ВРег(Похожий));
		КонецЦикла;
	КонецЕсли;
	
	Для Каждого МетаданныеСправочника Из Метаданные.Справочники Цикл
		
		ИмяВРег = ВРег(МетаданныеСправочника.Имя);
		СинонимВРег = ВРег(МетаданныеСправочника.Синоним);
		
		Если НЕ ПустаяСтрока(Фильтр) Тогда
			Найдено = Ложь;
			Для Каждого ТекущийФильтр Из МассивФильтров Цикл
				Если СтрНайти(ИмяВРег, ТекущийФильтр) > 0 
					ИЛИ СтрНайти(СинонимВРег, ТекущийФильтр) > 0 Тогда
					Найдено = Истина;
					Прервать;
				КонецЕсли;
			КонецЦикла;
			
			Если НЕ Найдено Тогда
				Продолжить;
			КонецЕсли;
		КонецЕсли;
		
		Элемент = Новый Структура;
		Элемент.Вставить("Имя", МетаданныеСправочника.Имя);
		Элемент.Вставить("ПолноеИмя", МетаданныеСправочника.ПолноеИмя());
		Элемент.Вставить("Синоним", МетаданныеСправочника.Синоним);
		
		Результат.Добавить(Элемент);
		
		// ОГРАНИЧЕНИЕ: Никогда не возвращаем более 20 объектов без фильтра (Context Saver)
		Если ПустаяСтрока(Фильтр) И Результат.Количество() >= 20 Тогда
			Прервать;
		КонецЕсли;
		
	КонецЦикла;
	
	Возврат Результат;
	
КонецФункции

// Получает список всех документов конфигурации
//
// Параметры:
//  Фильтр - Строка - (опционально) подстрока для поиска в имени или синониме
//
// Возвращаемое значение:
//  Массив - массив структур с информацией о документах:
//   * Имя - Строка - имя документа (полное, для GetObjectFields/RunQuery)
//   * ПолноеИмя - Строка - полное имя вида "Документ.Имя"
//   * Синоним - Строка - синоним документа
//
Функция ПолучитьСписокДокументов(Фильтр = "") Экспорт
	
	Результат = Новый Массив;
	ФильтрВРег = ВРег(Фильтр);
	
	// АВТО-РАСШИРЕНИЕ ФИЛЬТРА (если ничего не найдено по точному вхождению)
	МассивФильтров = Новый Массив;
	МассивФильтров.Добавить(ФильтрВРег);
	
	Если НЕ ПустаяСтрока(Фильтр) Тогда
		Похожие = НайтиПохожиеОбъекты(Фильтр, "Документ");
		Для Каждого Похожий Из Похожие Цикл
			МассивФильтров.Добавить(ВРег(Похожий));
		КонецЦикла;
	КонецЕсли;
	
	Для Каждого МетаданныеДокумента Из Метаданные.Документы Цикл
		
		ИмяВРег = ВРег(МетаданныеДокумента.Имя);
		СинонимВРег = ВРег(МетаданныеДокумента.Синоним);
		
		Если НЕ ПустаяСтрока(Фильтр) Тогда
			Найдено = Ложь;
			Для Каждого ТекущийФильтр Из МассивФильтров Цикл
				Если СтрНайти(ИмяВРег, ТекущийФильтр) > 0 
					ИЛИ СтрНайти(СинонимВРег, ТекущийФильтр) > 0 Тогда
					Найдено = Истина;
					Прервать;
				КонецЕсли;
			КонецЦикла;
			
			Если НЕ Найдено Тогда
				Продолжить;
			КонецЕсли;
		КонецЕсли;
		
		Элемент = Новый Структура;
		Элемент.Вставить("Имя", МетаданныеДокумента.Имя);
		Элемент.Вставить("ПолноеИмя", МетаданныеДокумента.ПолноеИмя());
		Элемент.Вставить("Синоним", МетаданныеДокумента.Синоним);
		
		Результат.Добавить(Элемент);
		
		// ОГРАНИЧЕНИЕ: Никогда не возвращаем более 20 объектов без фильтра (Context Saver)
		Если ПустаяСтрока(Фильтр) И Результат.Количество() >= 20 Тогда
			Прервать;
		КонецЕсли;
		
	КонецЦикла;
	
	Возврат Результат;
	
КонецФункции

// Получает список всех регистров сведений конфигурации
//
// Параметры:
//  Фильтр - Строка - (опционально) подстрока для поиска в имени или синониме
//
// Возвращаемое значение:
//  Массив - массив структур с информацией о регистрах:
//   * Имя - Строка - имя регистра (полное, для GetObjectFields/RunQuery)
//   * ПолноеИмя - Строка - полное имя вида "РегистрСведений.Имя"
//   * Синоним - Строка - синоним регистра
//
Функция ПолучитьСписокРегистровСведений(Фильтр = "") Экспорт
	
	Результат = Новый Массив;
	ФильтрВРег = ВРег(Фильтр);
	
	Для Каждого МетаданныеРегистра Из Метаданные.РегистрыСведений Цикл
		
		Если НЕ ПустаяСтрока(Фильтр) Тогда
			Если СтрНайти(ВРег(МетаданныеРегистра.Имя), ФильтрВРег) = 0 
				И СтрНайти(ВРег(МетаданныеРегистра.Синоним), ФильтрВРег) = 0 Тогда
				Продолжить;
			КонецЕсли;
		КонецЕсли;
		
		Элемент = Новый Структура;
		Элемент.Вставить("Имя", МетаданныеРегистра.Имя);
		Элемент.Вставить("ПолноеИмя", МетаданныеРегистра.ПолноеИмя());
		Элемент.Вставить("Синоним", МетаданныеРегистра.Синоним);
		
		Результат.Добавить(Элемент);
		
	КонецЦикла;
	
	Возврат Результат;
	
КонецФункции

// Получает список всех регистров накопления конфигурации
//
// Параметры:
//  Фильтр - Строка - (опционально) подстрока для поиска в имени или синониме
//
// Возвращаемое значение:
//  Массив - массив структур с информацией о регистрах:
//   * Имя - Строка - имя регистра (полное, для GetObjectFields/RunQuery)
//   * ПолноеИмя - Строка - полное имя вида "РегистрНакопления.Имя"
//   * Синоним - Строка - синоним регистра
//
Функция ПолучитьСписокРегистровНакопления(Фильтр = "") Экспорт
	
	Результат = Новый Массив;
	ФильтрВРег = ВРег(Фильтр);
	
	Для Каждого МетаданныеРегистра Из Метаданные.РегистрыНакопления Цикл
		
		Если НЕ ПустаяСтрока(Фильтр) Тогда
			Если СтрНайти(ВРег(МетаданныеРегистра.Имя), ФильтрВРег) = 0 
				И СтрНайти(ВРег(МетаданныеРегистра.Синоним), ФильтрВРег) = 0 Тогда
				Продолжить;
			КонецЕсли;
		КонецЕсли;
		
		Элемент = Новый Структура;
		Элемент.Вставить("Имя", МетаданныеРегистра.Имя);
		Элемент.Вставить("ПолноеИмя", МетаданныеРегистра.ПолноеИмя());
		Элемент.Вставить("Синоним", МетаданныеРегистра.Синоним);
		
		Результат.Добавить(Элемент);
		
	КонецЦикла;
	
	Возврат Результат;
	
КонецФункции

// Получает список всех регистров бухгалтерии конфигурации
//
// Параметры:
//  Фильтр - Строка - (опционально) подстрока для поиска в имени или синониме
//
// Возвращаемое значение:
//  Массив - массив структур с информацией о регистрах:
//   * Имя - Строка - имя регистра (полное, для GetObjectFields/RunQuery)
//   * ПолноеИмя - Строка - полное имя вида "РегистрБухгалтерии.Имя"
//   * Синоним - Строка - синоним регистра
//
Функция ПолучитьСписокРегистровБухгалтерии(Фильтр = "") Экспорт
	
	Результат = Новый Массив;
	ФильтрВРег = ВРег(Фильтр);
	
	Для Каждого МетаданныеРегистра Из Метаданные.РегистрыБухгалтерии Цикл
		
		Если НЕ ПустаяСтрока(Фильтр) Тогда
			Если СтрНайти(ВРег(МетаданныеРегистра.Имя), ФильтрВРег) = 0 
				И СтрНайти(ВРег(МетаданныеРегистра.Синоним), ФильтрВРег) = 0 Тогда
				Продолжить;
			КонецЕсли;
		КонецЕсли;
		
		Элемент = Новый Структура;
		Элемент.Вставить("Имя", МетаданныеРегистра.Имя);
		Элемент.Вставить("ПолноеИмя", МетаданныеРегистра.ПолноеИмя());
		Элемент.Вставить("Синоним", МетаданныеРегистра.Синоним);
		
		Результат.Добавить(Элемент);
		
	КонецЦикла;
	
	Возврат Результат;
	
КонецФункции

// Получает реквизиты справочника
//
// Параметры:
//  ИмяСправочника - Строка - имя справочника
//
// Возвращаемое значение:
//  Структура - структура с информацией о справочнике:
//   * Найден - Булево - найден ли справочник
//   * Имя - Строка - имя справочника
//   * Синоним - Строка - синоним справочника
//   * Реквизиты - Массив - массив структур с реквизитами:
//     * Имя - Строка - имя реквизита
//     * Синоним - Строка - синоним реквизита
//     * Тип - Строка - строковое представление типа
//
Функция ПолучитьРеквизитыСправочника(ИмяСправочника) Экспорт
	
	Результат = Новый Структура;
	Результат.Вставить("Найден", Ложь);
	Результат.Вставить("Имя", "");
	Результат.Вставить("Синоним", "");
	Результат.Вставить("Реквизиты", Новый Массив);
	
	МетаданныеСправочника = Метаданные.Справочники.Найти(ИмяСправочника);
	
	Если МетаданныеСправочника = Неопределено Тогда
		Возврат Результат;
	КонецЕсли;
	
	Результат.Найден = Истина;
	Результат.Имя = МетаданныеСправочника.Имя;
	Результат.Синоним = МетаданныеСправочника.Синоним;
	
	// Получаем реквизиты
	Для Каждого Реквизит Из МетаданныеСправочника.Реквизиты Цикл
		
		Элемент = Новый Структура;
		Элемент.Вставить("Имя", Реквизит.Имя);
		Элемент.Вставить("Синоним", Реквизит.Синоним);
		Элемент.Вставить("Тип", ПолучитьСтроковоеПредставлениеТипа(Реквизит.Тип));
		
		Результат.Реквизиты.Добавить(Элемент);
		
	КонецЦикла;
	
	// Добавляем основные стандартные реквизиты
	СписoкСтандартных = Новый Массив;
	СписoкСтандартных.Добавить("Код");
	СписoкСтандартных.Добавить("Наименование");
	СписoкСтандартных.Добавить("ПометкаУдаления");
	СписoкСтандартных.Добавить("ЭтоГруппа");
	СписoкСтандартных.Добавить("Родитель");
	СписoкСтандартных.Добавить("Владелец");

	
	Для Каждого ИмяСтандартного Из СписoкСтандартных Цикл
		
		Элемент = Новый Структура;
		Элемент.Вставить("Имя", ИмяСтандартного);
				
		Результат.Реквизиты.Добавить(Элемент);

	КонецЦикла;
	
	Возврат Результат;
	
КонецФункции

// Получает реквизиты документа
//
// Параметры:
//  ИмяДокумента - Строка - имя документа
//
// Возвращаемое значение:
//  Структура - структура с информацией о документе:
//   * Найден - Булево - найден ли документ
//   * Имя - Строка - имя документа
//   * Синоним - Строка - синоним документа
//   * Реквизиты - Массив - массив структур с реквизитами
//   * ТабличныеЧасти - Массив - массив структур с табличными частями
//
Функция ПолучитьРеквизитыДокумента(ИмяДокумента) Экспорт
	
	Результат = Новый Структура;
	Результат.Вставить("Найден", Ложь);
	Результат.Вставить("Имя", "");
	Результат.Вставить("Синоним", "");
	Результат.Вставить("Реквизиты", Новый Массив);
	Результат.Вставить("ТабличныеЧасти", Новый Массив);
	
	МетаданныеДокумента = Метаданные.Документы.Найти(ИмяДокумента);
	
	Если МетаданныеДокумента = Неопределено Тогда
		Возврат Результат;
	КонецЕсли;
	
	Результат.Найден = Истина;
	Результат.Имя = МетаданныеДокумента.Имя;
	Результат.Синоним = МетаданныеДокумента.Синоним;
	
	// Получаем реквизиты
	Для Каждого Реквизит Из МетаданныеДокумента.Реквизиты Цикл
		
		Элемент = Новый Структура;
		Элемент.Вставить("Имя", Реквизит.Имя);
		Элемент.Вставить("Синоним", Реквизит.Синоним);
		Элемент.Вставить("Тип", ПолучитьСтроковоеПредставлениеТипа(Реквизит.Тип));
		
		Результат.Реквизиты.Добавить(Элемент);
		
	КонецЦикла;
	
	// Добавляем основные стандартные реквизиты
	СписoкСтандартных = Новый Массив;
	СписoкСтандартных.Добавить("Номер");
	СписoкСтандартных.Добавить("Дата");
	СписoкСтандартных.Добавить("ПометкаУдаления");
	СписoкСтандартных.Добавить("Проведен");
	
	Для Каждого ИмяСтандартного Из СписoкСтандартных Цикл
		
		Элемент = Новый Структура;
		Элемент.Вставить("Имя", ИмяСтандартного);
		
		Результат.Реквизиты.Добавить(Элемент);
		
	КонецЦикла;
	
	// Получаем табличные части
	Для Каждого ТабличнаяЧасть Из МетаданныеДокумента.ТабличныеЧасти Цикл
		
		Элемент = Новый Структура;
		Элемент.Вставить("Имя", ТабличнаяЧасть.Имя);
		Элемент.Вставить("Синоним", ТабличнаяЧасть.Синоним);
		
		Результат.ТабличныеЧасти.Добавить(Элемент);
		
	КонецЦикла;
	
	Возврат Результат;
	
КонецФункции

// Проверяет существование справочника
//
// Параметры:
//  ИмяСправочника - Строка - имя справочника
//
// Возвращаемое значение:
//  Булево - существует ли справочник
//
Функция СуществуетСправочник(ИмяСправочника) Экспорт
	
	Возврат Метаданные.Справочники.Найти(ИмяСправочника) <> Неопределено;
	
КонецФункции

// Проверяет существование документа
//
// Параметры:
//  ИмяДокумента - Строка - имя документа
//
// Возвращаемое значение:
//  Булево - существует ли документ
//
Функция СуществуетДокумент(ИмяДокумента) Экспорт
	
	Возврат Метаданные.Документы.Найти(ИмяДокумента) <> Неопределено;
	
КонецФункции

// Ищет похожие объекты в метаданных (использует RAG поиск для максимальной точности)
//
// Параметры:
//  ИмяДляПоиска - Строка - имя или часть имени объекта
//  ТипМетаданных - Строка - "Справочник" или "Документ"
//
// Возвращаемое значение:
//  Массив - массив имен похожих объектов, отсортированный по релевантности
//
Функция НайтиПохожиеОбъекты(ИмяДляПоиска, ТипМетаданных) Экспорт
	
	Результат = Новый Массив;
	
	// Используем RAG поиск вместо расстояния Левенштейна.
	// Это даст более точные результаты с учетом синонимов и стемминга.
	РезультатыRAG = ИИА_RAG_Поиск.ВыполнитьПоиск(ИмяДляПоиска, 10);
	
	Для Каждого СтрокаRAG Из РезультатыRAG Цикл
		
		// RAG возвращает Тип и Имя отдельно (поля ПолноеИмя нет) — формируем префикс для фильтрации
		ТипРус = СтрокаRAG.Тип;
		ТипРус = СтрЗаменить(ТипРус, "Document", "Документ");
		ТипРус = СтрЗаменить(ТипРус, "Catalog", "Справочник");
		ТипРус = СтрЗаменить(ТипРус, "InfoReg", "РегистрСведений");
		ТипРус = СтрЗаменить(ТипРус, "AccumReg", "РегистрНакопления");
		
		// Фильтруем по типу, если он задан
		Если НЕ ПустаяСтрока(ТипМетаданных) Тогда
			Если ТипМетаданных = "Справочник" И НЕ СтрНачинаетсяС(ТипРус, "Справочник") Тогда
				Продолжить;
			ИначеЕсли ТипМетаданных = "Документ" И НЕ СтрНачинаетсяС(ТипРус, "Документ") Тогда
				Продолжить;
			КонецЕсли;
		КонецЕсли;
		
		Результат.Добавить(СтрокаRAG.Имя);
		
		Если Результат.Количество() >= 10 Тогда
			Прервать;
		КонецЕсли;
		
	КонецЦикла;
	
	// Если RAG ничего не нашел (например, индекс пуст), возвращаем пустой массив.
	// Старая логика с Левенштейном удалена для чистоты кода.
	
	Возврат Результат;
	
КонецФункции

// Вычисляет коэффициент сходства строк (от 0 до 1)
// на основе расстояния Левенштейна
Функция ВычислитьКоэффициентСходства(Строка1, Строка2) Экспорт
	
	Длина1 = СтрДлина(Строка1);
	Длина2 = СтрДлина(Строка2);
	
	Если Длина1 = 0 И Длина2 = 0 Тогда
		Возврат 1;
	ИначеЕсли Длина1 = 0 ИЛИ Длина2 = 0 Тогда
		Возврат 0;
	КонецЕсли;
	
	Расстояние = РасстояниеЛевенштейна(Строка1, Строка2);
	МаксДлина = Макс(Длина1, Длина2);
	
	Возврат (МаксДлина - Расстояние) / МаксДлина;
	
КонецФункции

// Реализация алгоритма Левенштейна (редакторское расстояние)
Функция РасстояниеЛевенштейна(Строка1, Строка2) Экспорт
	
	н_длина = СтрДлина(Строка1);
	м_длина = СтрДлина(Строка2);
	
	Если н_длина = 0 Тогда Возврат м_длина; КонецЕсли;
	Если м_длина = 0 Тогда Возврат н_длина; КонецЕсли;
	
	// Используем одномерный массив для экономии памяти (оптимизация)
	ПредыдущаяСтрока = Новый Массив(м_длина + 1);
	ТекущаяСтрока = Новый Массив(м_длина + 1);
	
	Для ж_инд = 0 По м_длина Цикл
		ПредыдущаяСтрока[ж_инд] = ж_инд;
	КонецЦикла;
	
	Для и_инд = 1 По н_длина Цикл
		ТекущаяСтрока[0] = и_инд;
		Символ1 = Сред(Строка1, и_инд, 1);
		
		Для ж_инд = 1 По м_длина Цикл
			Символ2 = Сред(Строка2, ж_инд, 1);
			СтоимостьЗамены = ?(Символ1 = Символ2, 0, 1);
			
			ТекущаяСтрока[ж_инд] = Мин(
				ТекущаяСтрока[ж_инд-1] + 1,      // Вставка
				ПредыдущаяСтрока[ж_инд] + 1,     // Удаление
				ПредыдущаяСтрока[ж_инд-1] + СтоимостьЗамены // Замена
			);
		КонецЦикла;
		
		// Копируем текущую строку в предыдущую
		Для ж_инд = 0 По м_длина Цикл
			ПредыдущаяСтрока[ж_инд] = ТекущаяСтрока[ж_инд];
		КонецЦикла;
	КонецЦикла;
	
	Возврат ТекущаяСтрока[м_длина];
	
КонецФункции

// Проверяет существование реквизита в справочнике
//
// Параметры:
//  ИмяСправочника - Строка - имя справочника
//  ИмяРеквизита - Строка - имя реквизита
//
// Возвращаемое значение:
//  Булево - существует ли реквизит
//
Функция СуществуетРеквизитСправочника(ИмяСправочника, ИмяРеквизита) Экспорт
	
	МетаданныеСправочника = Метаданные.Справочники.Найти(ИмяСправочника);
	
	Если МетаданныеСправочника = Неопределено Тогда
		Возврат Ложь;
	КонецЕсли;
	
	// Проверяем обычные реквизиты
	Если МетаданныеСправочника.Реквизиты.Найти(ИмяРеквизита) <> Неопределено Тогда
		Возврат Истина;
	КонецЕсли;
	
	// Проверяем стандартные реквизиты
	// Стандартные реквизиты справочника: Код, Наименование (Description — алиас), Ссылка, ПометкаУдаления, Предопределенный, ЭтоГруппа
	СтандартныеРеквизитыСправочника = Новый Массив;
	СтандартныеРеквизитыСправочника.Добавить("Код");
	СтандартныеРеквизитыСправочника.Добавить("Наименование");
	СтандартныеРеквизитыСправочника.Добавить("Description");
	СтандартныеРеквизитыСправочника.Добавить("Ссылка");
	СтандартныеРеквизитыСправочника.Добавить("ПометкаУдаления");
	СтандартныеРеквизитыСправочника.Добавить("Предопределенный");
	СтандартныеРеквизитыСправочника.Добавить("ЭтоГруппа");
	
	Для Каждого СтандартныйРеквизит Из СтандартныеРеквизитыСправочника Цикл
		Если ВРег(СтандартныйРеквизит) = ВРег(ИмяРеквизита) Тогда
			Возврат Истина;
		КонецЕсли;
	КонецЦикла;
	
	Возврат Ложь;
	
КонецФункции

// Проверяет существование реквизита в документе
//
// Параметры:
//  ИмяДокумента - Строка - имя документа
//  ИмяРеквизита - Строка - имя реквизита
//
// Возвращаемое значение:
//  Булево - существует ли реквизит
//
Функция СуществуетРеквизитДокумента(ИмяДокумента, ИмяРеквизита) Экспорт
	
	МетаданныеДокумента = Метаданные.Документы.Найти(ИмяДокумента);
	
	Если МетаданныеДокумента = Неопределено Тогда
		Возврат Ложь;
	КонецЕсли;
	
	// Проверяем обычные реквизиты
	Если МетаданныеДокумента.Реквизиты.Найти(ИмяРеквизита) <> Неопределено Тогда
		Возврат Истина;
	КонецЕсли;
	
	// Проверяем стандартные реквизиты
	// Стандартные реквизиты документа: Номер, Дата, Ссылка, ПометкаУдаления, Проведен
	СтандартныеРеквизитыДокумента = Новый Массив;
	СтандартныеРеквизитыДокумента.Добавить("Номер");
	СтандартныеРеквизитыДокумента.Добавить("Дата");
	СтандартныеРеквизитыДокумента.Добавить("Ссылка");
	СтандартныеРеквизитыДокумента.Добавить("ПометкаУдаления");
	СтандартныеРеквизитыДокумента.Добавить("Проведен");
	
	Для Каждого СтандартныйРеквизит Из СтандартныеРеквизитыДокумента Цикл
		Если ВРег(СтандартныйРеквизит) = ВРег(ИмяРеквизита) Тогда
			Возврат Истина;
		КонецЕсли;
	КонецЦикла;
	
	Возврат Ложь;
	
КонецФункции

#КонецОбласти

#Область СлужебныеПроцедурыИФункции

// Получает строковое представление типа данных
//
// Параметры:
//  Тип - ОписаниеТипов - описание типа
//
// Возвращаемое значение:
//  Строка - строковое представление типа
//
Функция ПолучитьСтроковоеПредставлениеТипа(Тип)
	
	Если Тип.Типы().Количество() = 0 Тогда
		Возврат "Неопределено";
	КонецЕсли;
	
	ПервыйТип = Тип.Типы()[0];
	
	СтрокаТипа = Строка(ПервыйТип);
	
	Если СтрокаТипа = "Строка" Тогда
		Возврат "Строка";
	ИначеЕсли СтрокаТипа = "Число" Тогда
		Возврат "Число";
	ИначеЕсли СтрокаТипа = "Дата" Тогда
		Возврат "Дата";
	ИначеЕсли СтрокаТипа = "Булево" Тогда
		Возврат "Булево";
	ИначеЕсли СтрНачинаетсяС(СтрокаТипа, "СправочникСсылка.") Тогда
		Возврат СтрокаТипа;
	ИначеЕсли СтрНачинаетсяС(СтрокаТипа, "ДокументСсылка.") Тогда
		Возврат СтрокаТипа;
	ИначеЕсли СтрНачинаетсяС(СтрокаТипа, "ПеречислениеСсылка.") Тогда
		Возврат СтрокаТипа;
	Иначе
		Возврат СтрокаТипа;
	КонецЕсли;
	
КонецФункции

#КонецОбласти

