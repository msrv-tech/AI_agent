// Модуль для хранения настроек RAG: синонимы и стоп-слова

// Возвращает массив стоп-слов
//
// Возвращаемое значение:
//  Массив - Список стоп-слов
Функция ПолучитьСтопСлова() Экспорт
	
	СтопСлова = Новый Массив;
	СтопСлова.Добавить("и");
	СтопСлова.Добавить("в");
	СтопСлова.Добавить("во");
	СтопСлова.Добавить("не");
	СтопСлова.Добавить("что");
	СтопСлова.Добавить("он");
	СтопСлова.Добавить("на");
	СтопСлова.Добавить("я");
	СтопСлова.Добавить("с");
	СтопСлова.Добавить("со");
	СтопСлова.Добавить("как");
	СтопСлова.Добавить("а");
	СтопСлова.Добавить("то");
	СтопСлова.Добавить("все");
	СтопСлова.Добавить("она");
	СтопСлова.Добавить("так");
	СтопСлова.Добавить("его");
	СтопСлова.Добавить("но");
	СтопСлова.Добавить("да");
	СтопСлова.Добавить("ты");
	СтопСлова.Добавить("к");
	СтопСлова.Добавить("у");
	СтопСлова.Добавить("же");
	СтопСлова.Добавить("вы");
	СтопСлова.Добавить("за");
	СтопСлова.Добавить("бы");
	СтопСлова.Добавить("по");
	СтопСлова.Добавить("только");
	СтопСлова.Добавить("ее");
	СтопСлова.Добавить("мне");
	СтопСлова.Добавить("было");
	СтопСлова.Добавить("вот");
	СтопСлова.Добавить("от");
	СтопСлова.Добавить("меня");
	СтопСлова.Добавить("еще");
	СтопСлова.Добавить("нет");
	СтопСлова.Добавить("о");
	СтопСлова.Добавить("из");
	СтопСлова.Добавить("ему");
	СтопСлова.Добавить("теперь");
	СтопСлова.Добавить("когда");
	СтопСлова.Добавить("даже");
	СтопСлова.Добавить("ну");
	СтопСлова.Добавить("вдруг");
	СтопСлова.Добавить("ли");
	СтопСлова.Добавить("if");
	СтопСлова.Добавить("если");
	СтопСлова.Добавить("уже");
	СтопСлова.Добавить("или");
	СтопСлова.Добавить("ни");
	СтопСлова.Добавить("быть");
	СтопСлова.Добавить("был");
	СтопСлова.Добавить("него");
	СтопСлова.Добавить("до");
	СтопСлова.Добавить("вас");
	СтопСлова.Добавить("нибудь");
	СтопСлова.Добавить("опять");
	СтопСлова.Добавить("уж");
	СтопСлова.Добавить("вам");
	СтопСлова.Добавить("ведь");
	СтопСлова.Добавить("там");
	СтопСлова.Добавить("потом");
	СтопСлова.Добавить("себя");
	СтопСлова.Добавить("ничего");
	СтопСлова.Добавить("ей");
	СтопСлова.Добавить("может");
	СтопСлова.Добавить("они");
	СтопСлова.Добавить("тут");
	СтопСлова.Добавить("где");
	СтопСлова.Добавить("есть");
	СтопСлова.Добавить("надо");
	СтопСлова.Добавить("ней");
	СтопСлова.Добавить("для");
	СтопСлова.Добавить("мы");
	СтопСлова.Добавить("тебя");
	СтопСлова.Добавить("их");
	СтопСлова.Добавить("чем");
	СтопСлова.Добавить("была");
	СтопСлова.Добавить("сам");
	СтопСлова.Добавить("чтоб");
	СтопСлова.Добавить("без");
	СтопСлова.Добавить("будто");
	СтопСлова.Добавить("чего");
	СтопСлова.Добавить("раз");
	СтопСлова.Добавить("тоже");
	СтопСлова.Добавить("себе");
	СтопСлова.Добавить("под");
	СтопСлова.Добавить("будет");
	СтопСлова.Добавить("ж");
	СтопСлова.Добавить("тогда");
	СтопСлова.Добавить("кто");
	СтопСлова.Добавить("этот");
	СтопСлова.Добавить("того");
	СтопСлова.Добавить("потому");
	СтопСлова.Добавить("этого");
	СтопСлова.Добавить("какой");
	СтопСлова.Добавить("совсем");
	СтопСлова.Добавить("ним");
	СтопСлова.Добавить("здесь");
	СтопСлова.Добавить("этом");
	СтопСлова.Добавить("один");
	СтопСлова.Добавить("почти");
	СтопСлова.Добавить("мой");
	СтопСлова.Добавить("тем");
	СтопСлова.Добавить("чтобы");
	СтопСлова.Добавить("нее");
	СтопСлова.Добавить("сейчас");
	СтопСлова.Добавить("были");
	СтопСлова.Добавить("куда");
	СтопСлова.Добавить("зачем");
	СтопСлова.Добавить("всех");
	СтопСлова.Добавить("никогда");
	СтопСлова.Добавить("можно");
	СтопСлова.Добавить("при");
	СтопСлова.Добавить("наконец");
	СтопСлова.Добавить("два");
	СтопСлова.Добавить("об");
	СтопСлова.Добавить("другой");
	СтопСлова.Добавить("хоть");
	СтопСлова.Добавить("после");
	СтопСлова.Добавить("над");
	СтопСлова.Добавить("больше");
	СтопСлова.Добавить("тот");
	СтопСлова.Добавить("через");
	СтопСлова.Добавить("эти");
	СтопСлова.Добавить("нас");
	СтопСлова.Добавить("про");
	СтопСлова.Добавить("всего");
	СтопСлова.Добавить("них");
	СтопСлова.Добавить("какая");
	СтопСлова.Добавить("много");
	СтопСлова.Добавить("разве");
	СтопСлова.Добавить("три");
	СтопСлова.Добавить("эту");
	СтопСлова.Добавить("моя");
	СтопСлова.Добавить("впрочем");
	СтопСлова.Добавить("хорошо");
	СтопСлова.Добавить("свою");
	СтопСлова.Добавить("этой");
	СтопСлова.Добавить("перед");
	СтопСлова.Добавить("иногда");
	СтопСлова.Добавить("лучше");
	СтопСлова.Добавить("чуть");
	СтопСлова.Добавить("нельзя");
	СтопСлова.Добавить("такой");
	СтопСлова.Добавить("им");
	СтопСлова.Добавить("более");
	СтопСлова.Добавить("всегда");
	СтопСлова.Добавить("конечно");
	СтопСлова.Добавить("всю");
	СтопСлова.Добавить("между");
	
	// Глаголы-команды и мусорные прилагательные
	СтопСлова.Добавить("найти");
	СтопСлова.Добавить("найди");
	СтопСлова.Добавить("покажи");
	СтопСлова.Добавить("открой");
	СтопСлова.Добавить("проанализируй");
	СтопСлова.Добавить("выдели");
	СтопСлова.Добавить("выведи");
	СтопСлова.Добавить("последний");
	СтопСлова.Добавить("последнюю");
	СтопСлова.Добавить("последние");
	СтопСлова.Добавить("сделай");
	СтопСлова.Добавить("создай");
	
	// Слова-интенты (относятся к логике запроса, а не к метаданным)
	СтопСлова.Добавить("сколько");
	СтопСлова.Добавить("количество");
	СтопСлова.Добавить("текущий");
	СтопСлова.Добавить("текущую");
	СтопСлова.Добавить("текущем");
	СтопСлова.Добавить("месяц");
	СтопСлова.Добавить("месяца");
	СтопСлова.Добавить("год");
	СтопСлова.Добавить("года");
	СтопСлова.Добавить("день");
	СтопСлова.Добавить("дня");
	
	Возврат СтопСлова;
	
КонецФункции

// Возвращает соответствие синонимов
//
// Возвращаемое значение:
//  Соответствие - Ключ: токен, Значение: Массив синонимов
Функция ПолучитьСинонимы() Экспорт
	
	Синонимы = Новый Соответствие;
	
	// Продажи
	Синонимы.Вставить("продажи", СтрРазделить("реализация,продажа,торговля,отгрузка", ",", Ложь));
	Синонимы.Вставить("динамика", СтрРазделить("продажи,реализация,изменение", ",", Ложь));
	Синонимы.Вставить("реализация", СтрРазделить("отгрузка,накладная,расходная,рту,продажа,торг12,упд,сф", ",", Ложь));
	Синонимы.Вставить("накладная", СтрРазделить("реализация,отгрузка,поступление,торг12,упд", ",", Ложь));
	Синонимы.Вставить("отгрузка", СтрРазделить("реализация,накладная", ",", Ложь));
	Синонимы.Вставить("продажа", СтрРазделить("реализация,торговля", ",", Ложь));
	
	// Закупки
	Синонимы.Вставить("поступление", СтрРазделить("закупка,приход,накладная", ",", Ложь));
	Синонимы.Вставить("закупка", СтрРазделить("поступление,приобретение", ",", Ложь));
	
	// Склад и остатки
	Синонимы.Вставить("остатки", СтрРазделить("товарынаскладах,складскиеостатки,наличие,товары,запасынаскладах", ",", Ложь));
	Синонимы.Вставить("остаток", СтрРазделить("остатки,товары,склад", ",", Ложь));
	Синонимы.Вставить("запасы", СтрРазделить("остатки,запасынаскладах,товарынаскладах,складскиеостатки", ",", Ложь));
	Синонимы.Вставить("склад", СтрРазделить("местохранения,склады", ",", Ложь));
	
	// Контрагенты
	Синонимы.Вставить("контрагент", СтрРазделить("партнер,клиент,покупатель,поставщик", ",", Ложь));
	Синонимы.Вставить("партнер", СтрРазделить("контрагент,клиент", ",", Ложь));
	Синонимы.Вставить("клиент", СтрРазделить("контрагент,партнер,покупатель", ",", Ложь));
	
	// Номенклатура
	Синонимы.Вставить("номенклатура", СтрРазделить("товар,продукция,услуга", ",", Ложь));
	Синонимы.Вставить("товар", СтрРазделить("номенклатура,продукция", ",", Ложь));
	
	// Деньги
	Синонимы.Вставить("деньги", СтрРазделить("денежныесредства,оплата,платеж,безнал,касса", ",", Ложь));
	Синонимы.Вставить("оплата", СтрРазделить("платеж,деньги,безнал,касса,заказ", ",", Ложь));
	Синонимы.Вставить("платежка", СтрРазделить("пп,платежное,поручение", ",", Ложь));
	
	// Дополнительно
	Синонимы.Вставить("счет", СтрРазделить("инвойс,оплата,заказ", ",", Ложь));
	Синонимы.Вставить("заказ", СтрРазделить("заявка,бронь,счет", ",", Ложь));
	Синонимы.Вставить("упд", СтрРазделить("сф,счетфактура,накладная,реализация", ",", Ложь));
	Синонимы.Вставить("сф", СтрРазделить("счетфактура,упд,реализация", ",", Ложь));
	Синонимы.Вставить("торг12", СтрРазделить("накладная,реализация", ",", Ложь));
	Синонимы.Вставить("цена", СтрРазделить("прайс,стоимость,тариф", ",", Ложь));
	Синонимы.Вставить("долг", СтрРазделить("задолженность,взаиморасчеты,дебиторка,кредиторка", ",", Ложь));
	Синонимы.Вставить("сотрудник", СтрРазделить("физлицо,персонал,работник", ",", Ложь));
	
	Возврат Синонимы;
	
КонецФункции

// Возвращает дополнительные ключевые слова для индексации объекта.
// Если имя/синоним объекта содержат СИНОНИМЫ (напр. "расходная", "накладная"),
// добавляем в чанк соответствующие КЛЮЧИ (напр. "реализация") для прямого совпадения при поиске.
//
// Параметры:
//  НормИмя - Строка - Нормализованное имя объекта
//  НормСиноним - Строка - Нормализованный синоним объекта
//
// Возвращаемое значение:
//  Массив из Строка - Дополнительные токены для индекса
Функция ПолучитьРасширяющиеКлючиДляИндекса(НормИмя, НормСиноним) Экспорт
	
	Синонимы = ПолучитьСинонимы();
	ДобавитьКлючи = Новый Массив;
	ОбъединённыйТекст = НормИмя + " " + НормСиноним;
	
	// Для каждого ключа (реализация, контрагент, ...) проверяем: есть ли его синонимы в тексте объекта
	Для каждого Пара Из Синонимы Цикл
		Ключ = Пара.Ключ;
		СписокСинонимов = Пара.Значение;
		Для каждого Синоним Из СписокСинонимов Цикл
			Если СтрДлина(Синоним) >= 4 И Найти(ОбъединённыйТекст, Синоним) > 0 Тогда
				Если ДобавитьКлючи.Найти(Ключ) = Неопределено Тогда
					ДобавитьКлючи.Добавить(Ключ);
				КонецЕсли;
				Прервать; // Один ключ — достаточно одного совпадения синонима
			КонецЕсли;
		КонецЦикла;
	КонецЦикла;
	
	Возврат ДобавитьКлючи;
	
КонецФункции
