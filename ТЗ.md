Цель расширения — сделать в 1С “ИИ-агента” по аналогии с Cursor IDE, который работает прямо в режиме 1С:Предприятие и:

понимает естественный язык пользователя,

сам оперирует данными и метаданными конфигурации,

выполняет только заранее разрешённые действия через безопасный DSL,

помогает разработчику и пользователю автоматизировать типовые операции.

Ниже цель разложена по блокам — это можно потом дать Cursor’у как «vision» задачи.

1. Главная цель

Создать в 1С расширение «ИИ-Агент», которое:

Работает в режиме предприятия, как панель/чат сбоку.

Принимает текстовые команды от пользователя (на русском).

Превращает их в структурированные действия (DSL-сценарий).

Безопасно выполняет эти действия в базе, не используя произвольный Выполнить().

Возвращает пользователю результат в удобном виде (текст, фрагменты кода/запросов, пояснения).

2. Что должен уметь агент (по аналогии с Cursor, но для 1С)
2.1. Работа с запросами 1С

Цели:

сэкономить время разработчика на написание и отладку запросов,

снизить количество ошибок в синтаксисе и именах полей.

Агент должен уметь:

Генерация запроса по задаче на естественном языке

Примеры команд:

«Сделай запрос, который выбирает всех контрагентов с пометкой “Поставщик”».

«Сформируй запрос по движениям регистра “Продажи” за месяц по номенклатуре».

Агент возвращает:

текст запроса языка запросов 1С,

в чат — блок с этим текстом.

Автоматическая валидация запроса на стороне 1С

Агент обязан проверить сгенерированный запрос, используя реальный механизм Новый Запрос(...).Выполнить().

При ошибке:

получить текст ошибки 1С,

при необходимости сформировать новую версию запроса с учётом ошибки,

сообщить пользователю, что именно было исправлено.

Чёткое разделение:

ИИ генерирует ТОЛЬКО текст запроса.

Проверка, корректировка и выполнение — на стороне 1С, под контролем агента.

2.2. Работа со справочниками и документами

Цель: дать возможность в интерактивном режиме:

находить объекты,

создавать новые элементы и документы,

изменять их реквизиты — в рамках заранее разрешённых сценариев.

Агент должен уметь по команде пользователя:

Найти справочник/документ по имени метаданных

Например: «Найди справочник Контрагенты»,
«Покажи реквизиты документа ЗаказКлиента».

Агент:

обращается к метаданным,

возвращает список полей/реквизитов, их типы, пометки.

Найти элемент справочника

Команды:

«Найди контрагента с наименованием “ООО Ромашка”».

«Покажи карточку номенклатуры “Сыр Российский”».

Агент должен:

через DSL-команду выполнить поиск по справочнику (по наименованию/коду),

вернуть пользователю краткую информацию (основные реквизиты),

при необходимости предложить действия: «Создать, если не найден», «Изменить реквизит…».

Создать элемент справочника

Примеры:

«Создай нового контрагента ООО Ромашка с ИНН таким-то».

«Добавь номенклатуру “Молоко 1л”, группа “Продукты”».

Агент:

формирует DSL-сценарий с шагами CreateReference, SetField, Write,

показывает пользователю план действий (какие поля будут заполнены),

выполняет его только в пределах разрешённых объектов/реквизитов.

Создать документ

Пример:

«Создай заказ клиента на контрагента ООО Ромашка на сумму 10 000».

Агент:

через DSL создаёт документ заданного вида,

заполняет ключевые реквизиты (Контрагент, Сумма),

записывает (по возможности без проведения, проведение можно сделать отдельным явным действием).

3. Работа с метаданными

Цель: чтобы агент мог сам понимать структуру конфигурации, а не полагаться только на текст подсказки.

Агент должен уметь:

Получать список объектов метаданных:

Справочники, Документы, Регистры.

Получать реквизиты/табличные части конкретного объекта:

поля, типы, их технические имена.

Использовать эти данные:

при генерации запросов (правильные имена полей),

при генерации DSL-сценариев (правильные имена реквизитов).

4. Безопасный DSL — ключевое ограничение и цель

Цель: агент никогда не исполняет произвольный код на 1С, а работает только через строго описанный набор команд.

Основные требования к DSL:

Белый список действий

Агент может использовать ТОЛЬКО разрешённые команды, например:

CreateDocument

CreateReference

FindReferenceByName

SetField

Write

RunQuery (только чтение)

ShowInfo (сообщить пользователю результат)

Структурированный формат (JSON)

Сценарий выглядит как JSON-объект:

{
  "dsl_version": 1,
  "steps": [
    { "action": "CreateDocument", "object_name": "ЗаказКлиента" },
    { "action": "SetField", "field": "Контрагент", "value": "ООО Ромашка" },
    { "action": "SetField", "field": "СуммаДокумента", "value": 10000 },
    { "action": "Write" }
  ]
}


Валидация перед выполнением

Любой сценарий сначала проверяется (правильный JSON, известные action, разрешённые объекты).

При проблеме — пользователь видит ошибку, сценарий не выполняется.

Часть сценариев выполняется только по явному подтверждению пользователя

Создание/изменение данных — только после отображения плана действий в интерфейсе.

Для “опасных” действий (изменение большого числа объектов и т.п.) может быть дополнительное подтверждение.

5. Пользовательский опыт (как в Cursor, но в 1С)

Цель: минималистичная панель справа, вместо сложных форм и кучы вкладок.

Один чат, где пользователь пишет команды:

обычные вопросы,

задачи по запросам,

команды по данным:

«найди контрагента…»,

«создай документ…».

Агент отвечает:

текстом,

блоками кода (запрос 1С),

сообщениями о выполненных действиях (создан элемент, найден объект и т.п.).

История диалога хранится в 1С (справочник диалогов), чтобы:

использовать последние сообщения как контекст,

вернуться к прошлым операциям.

6. Главное ограничение и философия

Агент не заменяет разработчика, а:

ускоряет рутину,

помогает формировать запросы и сценарии,

аккуратно создаёт/правит данные в рамках чётко заданных правил.

Любое действие в базе проходит через безопасный слой DSL:

никакого свободного Выполнить() из текста модели,

никаких скрытых изменений в конфигурации.