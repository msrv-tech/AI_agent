# Инструкция по тестированию ИИ-агента

## Настройка подключения к Гигачат

1. Откройте регистр сведений **ИИА_НастройкиПользователей**
2. Создайте запись для текущего пользователя со следующими полями:
   - **Пользователь** - текущий пользователь
   - **Provider_BaseUrl** - `https://gigachat.devices.sberbank.ru` (или ваш URL)
   - **Provider_ApiKey** - ваш API ключ от Гигачат
   - **Provider_Type** - `GigaChat` (или оставьте пустым)
   - **РежимПодключения** - выберите нужный режим

## Тестирование основных функций

### 1. Тест обычного чата

1. Откройте форму **ИИА_Панель**
2. Введите сообщение: "Привет, как дела?"
3. Нажмите "Отправить"
4. Проверьте, что получен ответ от ИИ

### 2. Тест генерации запроса

1. В поле ввода введите: "Сделай запрос, который выбирает всех контрагентов"
2. Выберите тип сообщения "Запрос" (если есть переключатель)
3. Нажмите "Отправить"
4. Проверьте, что получен запрос на языке запросов 1С
5. Нажмите "Проверить запрос" для валидации

### 3. Тест создания элемента справочника через DSL

1. Введите команду: "Создай контрагента ООО Ромашка"
2. Нажмите "Отправить"
3. ИИ должен сгенерировать DSL-сценарий в формате JSON
4. Проверьте, что сценарий содержит шаги:
   - CreateReference
   - SetField
   - Write

### 4. Тест поиска элемента справочника

1. Введите: "Найди контрагента с наименованием ООО Ромашка"
2. Проверьте, что сгенерирован DSL-сценарий с действием FindReferenceByName

### 5. Тест создания документа

1. Введите: "Создай документ ЗаказКлиента на контрагента ООО Ромашка"
2. Проверьте DSL-сценарий с действием CreateDocument

### 6. Тест выполнения DSL

1. После получения DSL-сценария от ИИ
2. Если в ответе есть флаг "ВыполнитьDSL", сценарий выполнится автоматически
3. Иначе можно выполнить вручную через функцию `ИИА_Сервер.ВыполнитьDSLСценарий`

## Проверка обработки ошибок

### Тест валидации DSL

1. Создайте неверный DSL-сценарий (например, с несуществующим справочником)
2. Вызовите `ИИА_DSL.ПроверитьDSL(DSLJSON)`
3. Проверьте, что возвращена ошибка валидации

### Тест автоматического исправления

1. Выполните DSL-сценарий с ошибкой
2. Система должна автоматически попытаться исправить через ИИ
3. Проверьте сообщение об исправлении

## Проверка метаданных

1. Вызовите `ИИА_Метаданные.ПолучитьСписокСправочников()`
2. Проверьте, что возвращен список всех справочников конфигурации
3. Аналогично проверьте документы и регистры

## Важные замечания

- Убедитесь, что API ключ Гигачат действителен и имеет достаточный баланс
- Проверьте, что в конфигурации есть справочники и документы для тестирования
- При ошибках HTTP-запроса проверьте URL и формат API ключа
- Логи ошибок можно найти в сообщениях диалога

## Примеры команд для тестирования

- "Покажи список всех справочников"
- "Создай номенклатуру Молоко"
- "Найди документ ЗаказКлиента номер 1"
- "Сделай запрос по регистру Продажи за текущий месяц"
- "Создай контрагента с ИНН 1234567890"

