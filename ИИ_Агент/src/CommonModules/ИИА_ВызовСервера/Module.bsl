#Область ПрограммныйИнтерфейс

// Находит или создает диалог пользователя
//
// Параметры:
//  Пользователь - Строка - пользователь
//
// Возвращаемое значение:
//  СправочникСсылка.ИИА_Диалоги - ссылка на диалог
//
Функция НайтиИлиСоздатьДиалогПользователя(Пользователь) Экспорт
	
	Возврат ИИА_Сервер.НайтиИлиСоздатьДиалогПользователя(Пользователь);
	
КонецФункции

// Получает сообщения диалога
//
// Параметры:
//  СсылкаДиалога - СправочникСсылка.ИИА_Диалоги - ссылка на диалог
//  Количество - Число - количество сообщений
//
// Возвращаемое значение:
//  Массив - массив структур с сообщениями
//
Функция ПолучитьСообщенияДиалога(СсылкаДиалога, Количество = 50) Экспорт
	
	Возврат ИИА_Сервер.ПолучитьСообщенияДиалога(СсылкаДиалога, Количество);
	
КонецФункции

// Отправляет сообщение и получает ответ от ИИ
//
// Параметры:
//  СсылкаДиалога - СправочникСсылка.ИИА_Диалоги - ссылка на диалог
//  ТипСообщения - Строка - тип сообщения
//  Текст - Строка - текст сообщения
//
// Возвращаемое значение:
//  Структура - структура ответа
//
Функция ОтправитьСообщениеСервера(СсылкаДиалога, ТипСообщения, Текст) Экспорт
	
	Возврат ИИА_Сервер.ОтправитьСообщениеСервера(СсылкаДиалога, ТипСообщения, Текст);
	
КонецФункции

// Проверяет запрос 1С
//
// Параметры:
//  ТекстЗапроса - Строка - текст запроса
//
// Возвращаемое значение:
//  Структура - структура результата
//
Функция ПроверитьЗапрос(ТекстЗапроса) Экспорт
	
	Возврат ИИА_Сервер.ПроверитьЗапрос(ТекстЗапроса);
	
КонецФункции

// Добавляет системное сообщение в диалог
//
// Параметры:
//  СсылкаДиалога - СправочникСсылка.ИИА_Диалоги - ссылка на диалог
//  Текст - Строка - текст сообщения
//  ТипСообщения - ПеречислениеСсылка.ИИА_ТипСообщения - тип сообщения
//
Процедура ДобавитьСистемноеСообщениеНаСервере(СсылкаДиалога, Текст, ТипСообщения) Экспорт
	
	ИИА_Сервер.ДобавитьСообщениеВДиалог(
		СсылкаДиалога,
		Перечисления.ИИА_АвторСообщения.Система,
		ТипСообщения,
		Текст,
		"",
		"",
		0
	);
	
КонецПроцедуры

// Выполняет DSL-сценарий и добавляет системные сообщения в диалог
//
// Параметры:
//  СсылкаДиалога - СправочникСсылка.ИИА_Диалоги - ссылка на диалог
//  DSLJSON - Строка - JSON с DSL командами
//
// Возвращаемое значение:
//  Структура - структура результата выполнения DSL
//
Функция ВыполнитьDSLСценарий(СсылкаДиалога, DSLJSON) Экспорт
	
	Возврат ИИА_Сервер.ВыполнитьDSLСценарийССообщениями(СсылкаДиалога, DSLJSON);
	
КонецФункции

// Исправляет DSL-сценарий через ИИ при ошибке выполнения (использует обычную функцию ВызватьИИ)
//
// Параметры:
//  СсылкаДиалога - СправочникСсылка.ИИА_Диалоги - ссылка на диалог
//  ПромптИсправления - Строка - промпт для исправления DSL
//
// Возвращаемое значение:
//  Структура - структура ответа от ВызватьИИ (содержит DSL в поле DSL или Текст)
//
Функция ИсправитьDSLЧерезИИ(СсылкаДиалога, ПромптИсправления) Экспорт
	
	Возврат ИИА_Сервер.ИсправитьDSLЧерезИИ(СсылкаДиалога, ПромптИсправления);
	
КонецФункции

// Обновляет статус DSL в последнем сообщении диалога
//
// Параметры:
//  СсылкаДиалога - СправочникСсылка.ИИА_Диалоги - ссылка на диалог
//  НовыйСтатус - ПеречислениеСсылка.ИИА_СтатусDSL - новый статус DSL
//
Процедура ОбновитьСтатусDSLВПоследнемСообщении(СсылкаДиалога, НовыйСтатус) Экспорт
	
	ИИА_Сервер.ОбновитьСтатусDSLВПоследнемСообщении(СсылкаДиалога, НовыйСтатус);
	
КонецПроцедуры

// Извлекает DSL JSON из текста ответа ИИ
//
// Параметры:
//  Текст - Строка - текст, из которого нужно извлечь JSON
//
// Возвращаемое значение:
//  Строка - извлеченный JSON или пустая строка, если не найден
//
Функция ИзвлечьDSLИзОтвета(Текст) Экспорт
	
	Возврат ИИА_Провайдеры.ИзвлечьDSLИзТекста(Текст);
	
КонецФункции

// Проверяет результат выполнения задачи через ИИ
//
// Параметры:
//  СсылкаДиалога - СправочникСсылка.ИИА_Диалоги - ссылка на диалог
//  ТекстЗадачиПользователя - Строка - исходный текст задачи пользователя
//  РезультатDSL - Структура - результат выполнения DSL-сценария
//
// Возвращаемое значение:
//  Булево - Истина, если задача выполнена, Ложь - если нет
//
Функция ПроверитьРезультатВыполненияЗадачи(СсылкаДиалога, ТекстЗадачиПользователя, РезультатDSL) Экспорт
	
	Возврат ИИА_Сервер.ПроверитьРезультатВыполненияЗадачи(СсылкаДиалога, ТекстЗадачиПользователя, РезультатDSL, Неопределено);
	
КонецФункции

#КонецОбласти
