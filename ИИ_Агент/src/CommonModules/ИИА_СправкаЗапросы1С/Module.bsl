#Область ПрограммныйИнтерфейс

// Получает полную справку по синтаксису языка запросов 1С
//
// Возвращаемое значение:
//  Строка - полная справка по синтаксису языка запросов 1С
//
Функция ПолучитьПолнуюСправку() Экспорт
	
	Справка = "";
	
	Справка = Справка + ПолучитьСправкуОсновныеКонструкции() + Символы.ПС + Символы.ПС;
	Справка = Справка + ПолучитьСправкуОператорыСоединения() + Символы.ПС + Символы.ПС;
	Справка = Справка + ПолучитьСправкуФункцииДаты() + Символы.ПС + Символы.ПС;
	Справка = Справка + ПолучитьСправкуФункцииСтрок() + Символы.ПС + Символы.ПС;
	Справка = Справка + ПолучитьСправкуФункцииЧисел() + Символы.ПС + Символы.ПС;
	Справка = Справка + ПолучитьСправкуАгрегатныеФункции() + Символы.ПС + Символы.ПС;
	Справка = Справка + ПолучитьСправкуОператорыСравнения() + Символы.ПС + Символы.ПС;
	Справка = Справка + ПолучитьСправкуСпециальныеФункции() + Символы.ПС + Символы.ПС;
	Справка = Справка + ПолучитьСправкуВиртуальныеТаблицы() + Символы.ПС + Символы.ПС;
	Справка = Справка + ПолучитьСправкуПодзапросы() + Символы.ПС + Символы.ПС;
	Справка = Справка + ПолучитьСправкуОбъединения() + Символы.ПС + Символы.ПС;
	Справка = Справка + ПолучитьСправкуПараметры() + Символы.ПС + Символы.ПС;
	Справка = Справка + ПолучитьСправкуВажныеПравила() + Символы.ПС + Символы.ПС;
	
	Возврат Справка;
	
КонецФункции

// Получает справку по основным конструкциям языка запросов
//
// Возвращаемое значение:
//  Строка - справка по основным конструкциям
//
Функция ПолучитьСправкуОсновныеКонструкции() Экспорт
	
	Справка = "=== ОСНОВНЫЕ КОНСТРУКЦИИ ЯЗЫКА ЗАПРОСОВ 1С ===" + Символы.ПС + Символы.ПС +
	"1. ВЫБРАТЬ (SELECT) - выбор полей из таблиц" + Символы.ПС +
	"   Синтаксис: ВЫБРАТЬ <Поле1>, <Поле2> ..." + Символы.ПС +
	"   Пример: ВЫБРАТЬ Номенклатура.Наименование, Номенклатура.Цена" + Символы.ПС + Символы.ПС +
	"2. ИЗ (FROM) - указание источника данных" + Символы.ПС +
	"   Синтаксис: ИЗ <Таблица> КАК <Псевдоним>" + Символы.ПС +
	"   Пример: ИЗ Справочник.Номенклатура КАК Номенклатура" + Символы.ПС +
	"   Доступные источники:" + Символы.ПС +
	"   - Справочник.<ИмяСправочника>" + Символы.ПС +
	"   - Документ.<ИмяДокумента>" + Символы.ПС +
	"   - РегистрСведений.<ИмяРегистра>" + Символы.ПС +
	"   - РегистрНакопления.<ИмяРегистра>" + Символы.ПС +
	"   - РегистрБухгалтерии.<ИмяРегистра>" + Символы.ПС + Символы.ПС +
	"3. ГДЕ (WHERE) - фильтрация записей" + Символы.ПС +
	"   Синтаксис: ГДЕ <Условие>" + Символы.ПС +
	"   Пример: ГДЕ Номенклатура.Цена > 1000 И Номенклатура.ПометкаУдаления = ЛОЖЬ" + Символы.ПС + Символы.ПС +
	"4. СГРУППИРОВАТЬ ПО (GROUP BY) - группировка данных" + Символы.ПС +
	"   Синтаксис: СГРУППИРОВАТЬ ПО <Поле1>, <Поле2> ..." + Символы.ПС +
	"   Пример: СГРУППИРОВАТЬ ПО Номенклатура.ВидНоменклатуры" + Символы.ПС + Символы.ПС +
	"5. УПОРЯДОЧИТЬ ПО (ORDER BY) - сортировка результатов" + Символы.ПС +
	"   Синтаксис: УПОРЯДОЧИТЬ ПО <Поле> [ВОЗР | УБЫВ]" + Символы.ПС +
	"   Пример: УПОРЯДОЧИТЬ ПО Номенклатура.Цена УБЫВ" + Символы.ПС +
	"   ВОЗР - по возрастанию (по умолчанию)" + Символы.ПС +
	"   УБЫВ - по убыванию" + Символы.ПС + Символы.ПС +
	"6. ИТОГИ ПО - вычисление итогов" + Символы.ПС +
	"   Синтаксис: ИТОГИ <АгрегатнаяФункция> ПО <Поле>" + Символы.ПС +
	"   Пример: ИТОГИ СУММА(Сумма) ПО Номенклатура" + Символы.ПС + Символы.ПС +
	"7. ОГРАНИЧИТЬ (LIMIT) - ограничение количества записей" + Символы.ПС +
	"   Синтаксис: ОГРАНИЧИТЬ <Количество>" + Символы.ПС +
	"   Пример: ОГРАНИЧИТЬ 100" + Символы.ПС + Символы.ПС +
	"8. РАЗЛИЧНЫЕ (DISTINCT) - исключение дубликатов" + Символы.ПС +
	"   Синтаксис: ВЫБРАТЬ РАЗЛИЧНЫЕ <Поля>" + Символы.ПС +
	"   Пример: ВЫБРАТЬ РАЗЛИЧНЫЕ Номенклатура.ВидНоменклатуры" + Символы.ПС + Символы.ПС +
	"9. РАЗРЕШЕННЫЕ - выполнение запроса с учетом RLS (Row Level Security)" + Символы.ПС +
	"   Синтаксис: ВЫБРАТЬ РАЗРЕШЕННЫЕ <Поля>" + Символы.ПС +
	"   Пример: ВЫБРАТЬ РАЗРЕШЕННЫЕ Номенклатура.Наименование" + Символы.ПС +
	"   Примечание: РАЗРЕШЕННЫЕ применяет ограничения доступа на уровне записей (RLS)" + Символы.ПС + Символы.ПС +
	"10. ПЕРВЫЕ (TOP) - выбор первых N записей" + Символы.ПС +
	"    Синтаксис: ВЫБРАТЬ ПЕРВЫЕ <N> <Поля>" + Символы.ПС +
	"    Пример: ВЫБРАТЬ ПЕРВЫЕ 10 Номенклатура.Наименование" + Символы.ПС + Символы.ПС +
	"11. КАК (AS) - псевдонимы для полей и таблиц" + Символы.ПС +
	"    Синтаксис: <Поле> КАК <Псевдоним>" + Символы.ПС +
	"    Пример: Номенклатура.Наименование КАК НаименованиеНоменклатуры";
	
	Возврат Справка;
	
КонецФункции

// Получает справку по операторам соединения таблиц
//
// Возвращаемое значение:
//  Строка - справка по операторам соединения
//
Функция ПолучитьСправкуОператорыСоединения() Экспорт
	
	Справка = "=== ОПЕРАТОРЫ СОЕДИНЕНИЯ ТАБЛИЦ ===" + Символы.ПС + Символы.ПС +
	"1. ВНУТРЕННЕЕ СОЕДИНЕНИЕ (INNER JOIN)" + Символы.ПС +
	"   Возвращает только те записи, которые есть в обеих таблицах" + Символы.ПС +
	"   Синтаксис: <Таблица1> ВНУТРЕННЕЕ СОЕДИНЕНИЕ <Таблица2> ПО <Условие>" + Символы.ПС +
	"   Пример:" + Символы.ПС +
	"   ВЫБРАТЬ Заказы.Номер, Клиенты.Наименование" + Символы.ПС +
	"   ИЗ Документ.Заказ КАК Заказы" + Символы.ПС +
	"   ВНУТРЕННЕЕ СОЕДИНЕНИЕ Справочник.Клиенты КАК Клиенты" + Символы.ПС +
	"   ПО Заказы.Клиент = Клиенты.Ссылка" + Символы.ПС + Символы.ПС +
	"2. ЛЕВОЕ СОЕДИНЕНИЕ (LEFT JOIN)" + Символы.ПС +
	"   Возвращает все записи из левой таблицы и соответствующие из правой" + Символы.ПС +
	"   Синтаксис: <Таблица1> ЛЕВОЕ СОЕДИНЕНИЕ <Таблица2> ПО <Условие>" + Символы.ПС +
	"   Пример:" + Символы.ПС +
	"   ВЫБРАТЬ Заказы.Номер, Клиенты.Наименование" + Символы.ПС +
	"   ИЗ Документ.Заказ КАК Заказы" + Символы.ПС +
	"   ЛЕВОЕ СОЕДИНЕНИЕ Справочник.Клиенты КАК Клиенты" + Символы.ПС +
	"   ПО Заказы.Клиент = Клиенты.Ссылка" + Символы.ПС + Символы.ПС +
	"3. ПРАВОЕ СОЕДИНЕНИЕ (RIGHT JOIN)" + Символы.ПС +
	"   Возвращает все записи из правой таблицы и соответствующие из левой" + Символы.ПС +
	"   Синтаксис: <Таблица1> ПРАВОЕ СОЕДИНЕНИЕ <Таблица2> ПО <Условие>" + Символы.ПС + Символы.ПС +
	"4. ПОЛНОЕ СОЕДИНЕНИЕ (FULL JOIN)" + Символы.ПС +
	"   Возвращает все записи из обеих таблиц" + Символы.ПС +
	"   Синтаксис: <Таблица1> ПОЛНОЕ СОЕДИНЕНИЕ <Таблица2> ПО <Условие>" + Символы.ПС + Символы.ПС +
	"5. Условие соединения (ПО)" + Символы.ПС +
	"   Указывается после оператора соединения" + Символы.ПС +
	"   Пример: ПО Заказы.Клиент = Клиенты.Ссылка";
	
	Возврат Справка;
	
КонецФункции

// Получает справку по функциям работы с датами
//
// Возвращаемое значение:
//  Строка - справка по функциям работы с датами
//
Функция ПолучитьСправкуФункцииДаты() Экспорт
	
	Справка = "=== ФУНКЦИИ РАБОТЫ С ДАТАМИ ===" + Символы.ПС + Символы.ПС +
	"1. ДОБАВИТЬКДАТЕ(<Дата>, <ЕдиницаИзмерения>, <Количество>)" + Символы.ПС +
	"   Прибавляет или вычитает указанное количество единиц времени к дате" + Символы.ПС +
	"   Параметры:" + Символы.ПС +
	"   - Дата: начальная дата" + Символы.ПС +
	"   - ЕдиницаИзмерения: СЕКУНДА, МИНУТА, ЧАС, ДЕНЬ, НЕДЕЛЯ, МЕСЯЦ, КВАРТАЛ, ГОД" + Символы.ПС +
	"   - Количество: положительное (прибавить) или отрицательное (вычесть)" + Символы.ПС +
	"   Пример: ДОБАВИТЬКДАТЕ(ТекущаяДата(), ДЕНЬ, 10)" + Символы.ПС + Символы.ПС +
	"2. ДЕНЬ(<Дата>)" + Символы.ПС +
	"   Возвращает день месяца (1-31)" + Символы.ПС +
	"   Пример: ДЕНЬ(ТекущаяДата())" + Символы.ПС + Символы.ПС +
	"3. МЕСЯЦ(<Дата>)" + Символы.ПС +
	"   Возвращает месяц (1-12)" + Символы.ПС +
	"   Пример: МЕСЯЦ(ТекущаяДата())" + Символы.ПС + Символы.ПС +
	"4. ГОД(<Дата>)" + Символы.ПС +
	"   Возвращает год" + Символы.ПС +
	"   Пример: ГОД(ТекущаяДата())" + Символы.ПС + Символы.ПС +
	"5. НЕДЕЛЯГОДА(<Дата>)" + Символы.ПС +
	"   Возвращает номер недели в году (1-53)" + Символы.ПС +
	"   Пример: НЕДЕЛЯГОДА(ТекущаяДата())" + Символы.ПС + Символы.ПС +
	"6. ДЕНЬГОДА(<Дата>)" + Символы.ПС +
	"   Возвращает номер дня в году (1-366)" + Символы.ПС +
	"   Пример: ДЕНЬГОДА(ТекущаяДата())" + Символы.ПС + Символы.ПС +
	"7. ДЕНЬНЕДЕЛИ(<Дата>)" + Символы.ПС +
	"   Возвращает день недели (1-7, где 1 - понедельник)" + Символы.ПС +
	"   Пример: ДЕНЬНЕДЕЛИ(ТекущаяДата())" + Символы.ПС + Символы.ПС +
	"8. КВАРТАЛ(<Дата>)" + Символы.ПС +
	"   Возвращает квартал (1-4)" + Символы.ПС +
	"   Пример: КВАРТАЛ(ТекущаяДата())" + Символы.ПС + Символы.ПС +
	"9. НАЧАЛОПЕРИОДА(<Дата>, <ЕдиницаИзмерения>)" + Символы.ПС +
	"   Возвращает начало периода" + Символы.ПС +
	"   Единицы: МИНУТА, ЧАС, ДЕНЬ, НЕДЕЛЯ, МЕСЯЦ, КВАРТАЛ, ГОД" + Символы.ПС +
	"   Пример: НАЧАЛОПЕРИОДА(ТекущаяДата(), МЕСЯЦ)" + Символы.ПС + Символы.ПС +
	"10. КОНЕЦПЕРИОДА(<Дата>, <ЕдиницаИзмерения>)" + Символы.ПС +
	"    Возвращает конец периода" + Символы.ПС +
	"    Пример: КОНЕЦПЕРИОДА(ТекущаяДата(), МЕСЯЦ)" + Символы.ПС + Символы.ПС +
	"11. РАЗНОСТЬДАТ(<Дата1>, <Дата2>, <ЕдиницаИзмерения>)" + Символы.ПС +
	"    Возвращает разницу между датами в указанных единицах" + Символы.ПС +
	"    Пример: РАЗНОСТЬДАТ(ТекущаяДата(), ДатаДокумента, ДЕНЬ)" + Символы.ПС + Символы.ПС +
	"12. ТекущаяДата()" + Символы.ПС +
	"    Возвращает текущую дату и время" + Символы.ПС +
	"    Пример: ТекущаяДата()" + Символы.ПС + Символы.ПС +
	"13. ДАТАВРЕМЯ(<Год>, <Месяц>, <День>[, <Час>, <Минута>, <Секунда>])" + Символы.ПС +
	"    Создает дату из компонентов" + Символы.ПС +
	"    Пример: ДАТАВРЕМЯ(2024, 1, 15, 10, 30, 0)";
	
	Возврат Справка;
	
КонецФункции

// Получает справку по функциям работы со строками
//
// Возвращаемое значение:
//  Строка - справка по функциям работы со строками
//
Функция ПолучитьСправкуФункцииСтрок() Экспорт
	
	Справка = "=== ФУНКЦИИ РАБОТЫ СО СТРОКАМИ ===" + Символы.ПС + Символы.ПС +
	"1. ВРЕГ(<Строка>)" + Символы.ПС +
	"   Преобразует строку в верхний регистр" + Символы.ПС +
	"   Пример: ВРЕГ(Наименование)" + Символы.ПС + Символы.ПС +
	"2. НРЕГ(<Строка>)" + Символы.ПС +
	"   Преобразует строку в нижний регистр" + Символы.ПС +
	"   Пример: НРЕГ(Наименование)" + Символы.ПС + Символы.ПС +
	"3. ТРЕГ(<Строка>)" + Символы.ПС +
	"   Преобразует первый символ в верхний регистр, остальные в нижний" + Символы.ПС +
	"   Пример: ТРЕГ(Наименование)" + Символы.ПС + Символы.ПС +
	"4. ПОДОБНО - оператор сравнения (LIKE)" + Символы.ПС +
	"   Синтаксис: <Поле> ПОДОБНО ""<Шаблон>""" + Символы.ПС +
	"   Символы шаблона: % (любые символы), _ (один символ)" + Символы.ПС +
	"   Пример: ГДЕ Наименование ПОДОБНО ""%ООО%""" + Символы.ПС +
	"   ВАЖНО: ПОДОБНО - это оператор, а не функция. Используйте: Поле ПОДОБНО ""шаблон""" + Символы.ПС + Символы.ПС +
	"6. ЛЕВ(<Строка>, <Длина>)" + Символы.ПС +
	"   Возвращает левую часть строки указанной длины" + Символы.ПС +
	"   Пример: ЛЕВ(Наименование, 10)" + Символы.ПС + Символы.ПС +
	"7. ПРАВ(<Строка>, <Длина>)" + Символы.ПС +
	"   Возвращает правую часть строки указанной длины" + Символы.ПС +
	"   Пример: ПРАВ(Наименование, 10)" + Символы.ПС + Символы.ПС +
	"8. СРЕД(<Строка>, <НачальнаяПозиция>, <Длина>)" + Символы.ПС +
	"   Возвращает подстроку из середины строки" + Символы.ПС +
	"   Пример: СРЕД(Наименование, 1, 5)" + Символы.ПС + Символы.ПС +
	"5. ДЛИНА(<Строка>)" + Символы.ПС +
	"   Возвращает длину строки" + Символы.ПС +
	"   Пример: ДЛИНА(Наименование)" + Символы.ПС + Символы.ПС +
	"6. ЗАМЕНИТЬ(<Строка>, <ПодстрокаПоиска>, <ПодстрокаЗамены>)" + Символы.ПС +
	"   Заменяет вхождения подстроки" + Символы.ПС +
	"   Пример: ЗАМЕНИТЬ(Наименование, ""ООО"", ""Общество"")" + Символы.ПС + Символы.ПС +
	"7. СТРОКА(<Значение>)" + Символы.ПС +
	"   Преобразует значение в строку" + Символы.ПС +
	"   Пример: СТРОКА(Сумма)" + Символы.ПС + Символы.ПС +
	"8. ПУСТАЯСТРОКА(<Строка>)" + Символы.ПС +
	"   Проверяет, является ли строка пустой" + Символы.ПС +
	"   Пример: ГДЕ ПУСТАЯСТРОКА(Наименование) = ЛОЖЬ";
	
	Возврат Справка;
	
КонецФункции

// Получает справку по функциям работы с числами
//
// Возвращаемое значение:
//  Строка - справка по функциям работы с числами
//
Функция ПолучитьСправкуФункцииЧисел() Экспорт
	
	Справка = "=== ФУНКЦИИ РАБОТЫ С ЧИСЛАМИ ===" + Символы.ПС + Символы.ПС +
	"1. ОКР(<Число>[, <Точность>])" + Символы.ПС +
	"   Округляет число до указанной точности" + Символы.ПС +
	"   Пример: ОКР(Сумма, 2)" + Символы.ПС + Символы.ПС +
	"2. ЦЕЛ(<Число>)" + Символы.ПС +
	"   Возвращает целую часть числа" + Символы.ПС +
	"   Пример: ЦЕЛ(Сумма)" + Символы.ПС + Символы.ПС +
	"3. ОКРВВЕРХ(<Число>[, <Точность>])" + Символы.ПС +
	"   Округляет число вверх" + Символы.ПС +
	"   Пример: ОКРВВЕРХ(Сумма, 2)" + Символы.ПС + Символы.ПС +
	"4. ОКРВНИЗ(<Число>[, <Точность>])" + Символы.ПС +
	"   Округляет число вниз" + Символы.ПС +
	"   Пример: ОКРВНИЗ(Сумма, 2)" + Символы.ПС + Символы.ПС +
	"5. МАКС(<Значение1>, <Значение2>, ...)" + Символы.ПС +
	"   Возвращает максимальное значение" + Символы.ПС +
	"   Пример: МАКС(Сумма1, Сумма2)" + Символы.ПС + Символы.ПС +
	"6. МИН(<Значение1>, <Значение2>, ...)" + Символы.ПС +
	"   Возвращает минимальное значение" + Символы.ПС +
	"   Пример: МИН(Сумма1, Сумма2)" + Символы.ПС + Символы.ПС +
	"7. АБС(<Число>)" + Символы.ПС +
	"   Возвращает абсолютное значение числа" + Символы.ПС +
	"   Пример: АБС(Сумма)" + Символы.ПС + Символы.ПС +
	"8. ЧИСЛО(<Строка>)" + Символы.ПС +
	"   Преобразует строку в число" + Символы.ПС +
	"   Пример: ЧИСЛО(""123"")" + Символы.ПС + Символы.ПС +
	"9. ВЫРАЗИТЬ(<Значение> КАК <Тип>)" + Символы.ПС +
	"    Преобразует значение к указанному типу" + Символы.ПС +
	"    Пример: ВЫРАЗИТЬ(Сумма КАК Число(15, 2))";
	
	Возврат Справка;
	
КонецФункции

// Получает справку по агрегатным функциям
//
// Возвращаемое значение:
//  Строка - справка по агрегатным функциям
//
Функция ПолучитьСправкуАгрегатныеФункции() Экспорт
	
	Справка = "=== АГРЕГАТНЫЕ ФУНКЦИИ ===" + Символы.ПС + Символы.ПС +
	"Агрегатные функции используются с СГРУППИРОВАТЬ ПО" + Символы.ПС + Символы.ПС +
	"1. СУММА(<Поле>)" + Символы.ПС +
	"   Возвращает сумму значений" + Символы.ПС +
	"   Пример: СУММА(СуммаДокумента)" + Символы.ПС + Символы.ПС +
	"2. КОЛИЧЕСТВО(<Поле>)" + Символы.ПС +
	"   Возвращает количество записей" + Символы.ПС +
	"   Пример: КОЛИЧЕСТВО(Ссылка)" + Символы.ПС +
	"   Можно использовать КОЛИЧЕСТВО(*) для подсчета всех записей" + Символы.ПС + Символы.ПС +
	"3. КОЛИЧЕСТВОРАЗЛИЧНЫХ(<Поле>)" + Символы.ПС +
	"   Возвращает количество различных значений" + Символы.ПС +
	"   Пример: КОЛИЧЕСТВОРАЗЛИЧНЫХ(Контрагент)" + Символы.ПС + Символы.ПС +
	"4. СРЕДНЕЕ(<Поле>)" + Символы.ПС +
	"   Возвращает среднее значение" + Символы.ПС +
	"   Пример: СРЕДНЕЕ(СуммаДокумента)" + Символы.ПС + Символы.ПС +
	"5. МАКСИМУМ(<Поле>)" + Символы.ПС +
	"   Возвращает максимальное значение" + Символы.ПС +
	"   Пример: МАКСИМУМ(СуммаДокумента)" + Символы.ПС + Символы.ПС +
	"6. МИНИМУМ(<Поле>)" + Символы.ПС +
	"   Возвращает минимальное значение" + Символы.ПС +
	"   Пример: МИНИМУМ(СуммаДокумента)";
	
	Возврат Справка;
	
КонецФункции

// Получает справку по операторам сравнения и логическим операторам
//
// Возвращаемое значение:
//  Строка - справка по операторам сравнения
//
Функция ПолучитьСправкуОператорыСравнения() Экспорт
	
	Справка = "=== ОПЕРАТОРЫ СРАВНЕНИЯ И ЛОГИЧЕСКИЕ ОПЕРАТОРЫ ===" + Символы.ПС + Символы.ПС +
	"1. Операторы сравнения:" + Символы.ПС +
	"   = (равно)" + Символы.ПС +
	"   <> (не равно)" + Символы.ПС +
	"   > (больше)" + Символы.ПС +
	"   >= (больше или равно)" + Символы.ПС +
	"   < (меньше)" + Символы.ПС +
	"   <= (меньше или равно)" + Символы.ПС + Символы.ПС +
	"2. Логические операторы:" + Символы.ПС +
	"   И (AND) - логическое И" + Символы.ПС +
	"   ИЛИ (OR) - логическое ИЛИ" + Символы.ПС +
	"   НЕ (NOT) - логическое отрицание" + Символы.ПС + Символы.ПС +
	"3. Операторы для работы с NULL:" + Символы.ПС +
	"   ЕСТЬ NULL - проверка на NULL" + Символы.ПС +
	"   НЕ ЕСТЬ NULL - проверка на не NULL" + Символы.ПС +
	"   Пример: ГДЕ Поле ЕСТЬ NULL" + Символы.ПС +
	"   Пример: ГДЕ Поле НЕ ЕСТЬ NULL" + Символы.ПС + Символы.ПС +
	"4. Операторы для работы с булевыми значениями:" + Символы.ПС +
	"   ИСТИНА (TRUE)" + Символы.ПС +
	"   ЛОЖЬ (FALSE)" + Символы.ПС +
	"   Пример: ГДЕ ПометкаУдаления = ЛОЖЬ" + Символы.ПС + Символы.ПС +
	"5. Оператор ПОДОБНО (LIKE):" + Символы.ПС +
	"   Оператор сравнения, проверяет соответствие строки шаблону" + Символы.ПС +
	"   Синтаксис: <Поле> ПОДОБНО ""<Шаблон>""" + Символы.ПС +
	"   Символы шаблона: % (любые символы), _ (один символ)" + Символы.ПС +
	"   Пример: ГДЕ Наименование ПОДОБНО ""%ООО%""" + Символы.ПС + Символы.ПС +
	"6. Оператор В (IN):" + Символы.ПС +
	"   Проверяет вхождение значения в список" + Символы.ПС +
	"   Пример: ГДЕ Контрагент В (ВЫБРАТЬ Ссылка ИЗ Справочник.Контрагенты)" + Символы.ПС + Символы.ПС +
	"7. Оператор НЕ В (NOT IN):" + Символы.ПС +
	"   Проверяет отсутствие значения в списке" + Символы.ПС +
	"   Пример: ГДЕ Контрагент НЕ В (ВЫБРАТЬ Ссылка ИЗ Справочник.Контрагенты)" + Символы.ПС + Символы.ПС +
	"8. Операторы для работы с датами:" + Символы.ПС +
	"   МЕЖДУ ... И ... - проверка диапазона" + Символы.ПС +
	"   Пример: ГДЕ Дата МЕЖДУ ДАТАВРЕМЯ(2024, 1, 1) И ДАТАВРЕМЯ(2024, 12, 31)";
	
	Возврат Справка;
	
КонецФункции

// Получает справку по специальным функциям
//
// Возвращаемое значение:
//  Строка - справка по специальным функциям
//
Функция ПолучитьСправкуСпециальныеФункции() Экспорт
	
	Справка = "=== СПЕЦИАЛЬНЫЕ ФУНКЦИИ ===" + Символы.ПС + Символы.ПС +
	"1. ВЫРАЗИТЬ(<Значение> КАК <Тип>)" + Символы.ПС +
	"   Преобразует значение к указанному типу" + Символы.ПС +
	"   Пример: ВЫРАЗИТЬ(Сумма КАК Число(15, 2))" + Символы.ПС +
	"   Пример: ВЫРАЗИТЬ(Примечание КАК Строка(200))" + Символы.ПС + Символы.ПС +
	"2. ЕСТЬNULL(<Выражение1>, <Выражение2>)" + Символы.ПС +
	"   Возвращает первое выражение, если оно не NULL, иначе второе" + Символы.ПС +
	"   Пример: ЕСТЬNULL(Сумма, 0)" + Символы.ПС + Символы.ПС +
	"3. ВЫБОР КОГДА ... ТОГДА ... ИНАЧЕ ... КОНЕЦ" + Символы.ПС +
	"   Условное выражение (аналог CASE WHEN)" + Символы.ПС +
	"   Пример:" + Символы.ПС +
	"   ВЫБОР" + Символы.ПС +
	"       КОГДА Сумма > 1000 ТОГДА ""Большая""" + Символы.ПС +
	"       ИНАЧЕ ""Малая""" + Символы.ПС +
	"   КОНЕЦ КАК Категория" + Символы.ПС + Символы.ПС +
	"4. ЗНАЧЕНИЕ(<ТипЗначения>)" + Символы.ПС +
	"   Создает значение указанного типа" + Символы.ПС +
	"   Пример: ЗНАЧЕНИЕ(Справочник.Контрагенты.ПустаяСсылка)" + Символы.ПС + Символы.ПС +
	"5. ПРЕДСТАВЛЕНИЕ(<Значение>)" + Символы.ПС +
	"   Возвращает строковое представление значения" + Символы.ПС +
	"   Пример: ПРЕДСТАВЛЕНИЕ(Ссылка)" + Символы.ПС + Символы.ПС +
	"6. РАЗНОСТЬДАТ(<Дата1>, <Дата2>, <Единица>)" + Символы.ПС +
	"   Вычисляет разницу между датами" + Символы.ПС +
	"   Пример: РАЗНОСТЬДАТ(ТекущаяДата(), ДатаДокумента, ДЕНЬ)";
	
	Возврат Справка;
	
КонецФункции

// Получает справку по виртуальным таблицам
//
// Возвращаемое значение:
//  Строка - справка по виртуальным таблицам
//
Функция ПолучитьСправкуВиртуальныеТаблицы() Экспорт
	
	Справка = "=== ВИРТУАЛЬНЫЕ ТАБЛИЦЫ ===" + Символы.ПС + Символы.ПС +
	"Виртуальные таблицы используются для регистров" + Символы.ПС + Символы.ПС +
	"1. Регистры накопления:" + Символы.ПС +
	"   - Остатки - остатки на момент времени" + Символы.ПС +
	"   - Обороты - обороты за период" + Символы.ПС +
	"   - ОстаткиИОбороты - остатки и обороты" + Символы.ПС +
	"   Пример:" + Символы.ПС +
	"   ИЗ РегистрНакопления.ТоварыНаСкладах.Остатки(&МоментВремени, Склад = &Склад) КАК Остатки" + Символы.ПС + Символы.ПС +
	"2. Регистры сведений:" + Символы.ПС +
	"   - СрезПервых - срез первых значений" + Символы.ПС +
	"   - СрезПоследних - срез последних значений" + Символы.ПС +
	"   Пример:" + Символы.ПС +
	"   ИЗ РегистрСведений.ЦеныНоменклатуры.СрезПоследних(&МоментВремени, Номенклатура = &Номенклатура) КАК Цены" + Символы.ПС + Символы.ПС +
	"3. Регистры бухгалтерии:" + Символы.ПС +
	"   - Остатки - остатки на момент времени" + Символы.ПС +
	"   - Обороты - обороты за период" + Символы.ПС +
	"   - ОстаткиИОбороты - остатки и обороты" + Символы.ПС +
	"   Пример:" + Символы.ПС +
	"   ИЗ РегистрБухгалтерии.Хозрасчетный.Остатки(&МоментВремени, Счет = &Счет) КАК Остатки" + Символы.ПС + Символы.ПС +
	"4. Параметры виртуальных таблиц:" + Символы.ПС +
	"   - &МоментВремени - дата/время для среза" + Символы.ПС +
	"   - &НачалоПериода - начало периода для оборотов" + Символы.ПС +
	"   - &КонецПериода - конец периода для оборотов" + Символы.ПС +
	"   - Условия отбора (например, Склад = &Склад)" + Символы.ПС + Символы.ПС +
	"5. Пример запроса с виртуальной таблицей:" + Символы.ПС +
	"   ВЫБРАТЬ" + Символы.ПС +
	"       Остатки.Номенклатура," + Символы.ПС +
	"       Остатки.КоличествоОстаток" + Символы.ПС +
	"   ИЗ" + Символы.ПС +
	"       РегистрНакопления.ТоварыНаСкладах.Остатки(&МоментВремени) КАК Остатки" + Символы.ПС +
	"   ГДЕ" + Символы.ПС +
	"       Остатки.Склад = &Склад";
	
	Возврат Справка;
	
КонецФункции

// Получает справку по подзапросам
//
// Возвращаемое значение:
//  Строка - справка по подзапросам
//
Функция ПолучитьСправкуПодзапросы() Экспорт
	
	Справка = "=== ПОДЗАПРОСЫ ===" + Символы.ПС + Символы.ПС +
	"Подзапросы используются для вложенных выборок" + Символы.ПС + Символы.ПС +
	"1. Подзапрос в условии В:" + Символы.ПС +
	"   ВЫБРАТЬ *" + Символы.ПС +
	"   ИЗ Документ.Заказ КАК Заказы" + Символы.ПС +
	"   ГДЕ Заказы.Контрагент В (" + Символы.ПС +
	"       ВЫБРАТЬ Ссылка" + Символы.ПС +
	"       ИЗ Справочник.Контрагенты КАК Контрагенты" + Символы.ПС +
	"       ГДЕ Контрагенты.ПометкаУдаления = ЛОЖЬ" + Символы.ПС +
	"   )" + Символы.ПС + Символы.ПС +
	"2. Подзапрос в списке полей:" + Символы.ПС +
	"   ВЫБРАТЬ" + Символы.ПС +
	"       Контрагенты.Наименование," + Символы.ПС +
	"       (ВЫБРАТЬ СУММА(СуммаДокумента)" + Символы.ПС +
	"        ИЗ Документ.Заказ КАК Заказы" + Символы.ПС +
	"        ГДЕ Заказы.Контрагент = Контрагенты.Ссылка) КАК ОбщаяСумма" + Символы.ПС +
	"   ИЗ Справочник.Контрагенты КАК Контрагенты" + Символы.ПС + Символы.ПС +
	"3. Подзапрос с СУЩЕСТВУЕТ (EXISTS):" + Символы.ПС +
	"   ВЫБРАТЬ *" + Символы.ПС +
	"   ИЗ Справочник.Контрагенты КАК Контрагенты" + Символы.ПС +
	"   ГДЕ СУЩЕСТВУЕТ (" + Символы.ПС +
	"       ВЫБРАТЬ *" + Символы.ПС +
	"       ИЗ Документ.Заказ КАК Заказы" + Символы.ПС +
	"       ГДЕ Заказы.Контрагент = Контрагенты.Ссылка" + Символы.ПС +
	"   )" + Символы.ПС + Символы.ПС +
	"4. Подзапрос с НЕ СУЩЕСТВУЕТ (NOT EXISTS):" + Символы.ПС +
	"   ВЫБРАТЬ *" + Символы.ПС +
	"   ИЗ Справочник.Контрагенты КАК Контрагенты" + Символы.ПС +
	"   ГДЕ НЕ СУЩЕСТВУЕТ (" + Символы.ПС +
	"       ВЫБРАТЬ *" + Символы.ПС +
	"       ИЗ Документ.Заказ КАК Заказы" + Символы.ПС +
	"       ГДЕ Заказы.Контрагент = Контрагенты.Ссылка" + Символы.ПС +
	"   )";
	
	Возврат Справка;
	
КонецФункции

// Получает справку по объединениям запросов
//
// Возвращаемое значение:
//  Строка - справка по объединениям
//
Функция ПолучитьСправкуОбъединения() Экспорт
	
	Справка = "=== ОБЪЕДИНЕНИЯ ЗАПРОСОВ ===" + Символы.ПС + Символы.ПС +
	"1. ОБЪЕДИНИТЬ (UNION) - объединение без дубликатов" + Символы.ПС +
	"   ВЫБРАТЬ Наименование ИЗ Справочник.Контрагенты" + Символы.ПС +
	"   ОБЪЕДИНИТЬ" + Символы.ПС +
	"   ВЫБРАТЬ Наименование ИЗ Справочник.Поставщики" + Символы.ПС + Символы.ПС +
	"2. ОБЪЕДИНИТЬ ВСЕ (UNION ALL) - объединение с дубликатами" + Символы.ПС +
	"   ВЫБРАТЬ Наименование ИЗ Справочник.Контрагенты" + Символы.ПС +
	"   ОБЪЕДИНИТЬ ВСЕ" + Символы.ПС +
	"   ВЫБРАТЬ Наименование ИЗ Справочник.Поставщики" + Символы.ПС + Символы.ПС +
	"ВАЖНО: Все запросы в объединении должны иметь одинаковое количество полей и совместимые типы" + Символы.ПС +
	"ПРИМЕЧАНИЕ: В языке запросов 1С нет операторов РАЗНОСТЬ (EXCEPT) и ПЕРЕСЕЧЕНИЕ (INTERSECT)";
	
	Возврат Справка;
	
КонецФункции

// Получает справку по параметрам запросов
//
// Возвращаемое значение:
//  Строка - справка по параметрам
//
Функция ПолучитьСправкуПараметры() Экспорт
	
	Справка = "=== ПАРАМЕТРЫ ЗАПРОСОВ ===" + Символы.ПС + Символы.ПС +
	"Параметры используются для передачи значений в запрос" + Символы.ПС + Символы.ПС +
	"1. Синтаксис параметра: &<ИмяПараметра>" + Символы.ПС +
	"   Пример: ГДЕ Дата = &ДатаНачала" + Символы.ПС + Символы.ПС +
	"2. Установка параметра в коде:" + Символы.ПС +
	"   Запрос.УстановитьПараметр(""ДатаНачала"", ДАТАВРЕМЯ(2024, 1, 1))" + Символы.ПС + Символы.ПС +
	"3. Типы параметров:" + Символы.ПС +
	"   - Число: &Сумма" + Символы.ПС +
	"   - Строка: &Наименование" + Символы.ПС +
	"   - Дата: &ДатаНачала" + Символы.ПС +
	"   - Ссылка: &Контрагент" + Символы.ПС +
	"   - Булево: &ПометкаУдаления" + Символы.ПС +
	"   - Массив: &МассивСсылок" + Символы.ПС + Символы.ПС +
	"4. Использование параметров в условиях:" + Символы.ПС +
	"   ГДЕ Дата МЕЖДУ &НачалоПериода И &КонецПериода" + Символы.ПС +
	"   ГДЕ Контрагент = &Контрагент" + Символы.ПС +
	"   ГДЕ Наименование ПОДОБНО &Шаблон" + Символы.ПС + Символы.ПС +
	"5. Использование параметров в виртуальных таблицах:" + Символы.ПС +
	"   ИЗ РегистрНакопления.Товары.Остатки(&МоментВремени) КАК Остатки" + Символы.ПС + Символы.ПС +
	"6. Массивы в параметрах:" + Символы.ПС +
	"   МассивСсылок = Новый Массив;" + Символы.ПС +
	"   МассивСсылок.Добавить(Ссылка1);" + Символы.ПС +
	"   МассивСсылок.Добавить(Ссылка2);" + Символы.ПС +
	"   Запрос.УстановитьПараметр(""МассивСсылок"", МассивСсылок);" + Символы.ПС +
	"   ГДЕ Ссылка В &МассивСсылок";
	
	Возврат Справка;
	
КонецФункции

// Получает справку по важным правилам и ограничениям
//
// Возвращаемое значение:
//  Строка - справка по важным правилам
//
Функция ПолучитьСправкуВажныеПравила() Экспорт
	
	Справка = "=== ВАЖНЫЕ ПРАВИЛА И ОГРАНИЧЕНИЯ ===" + Символы.ПС + Символы.ПС +
	"1. СТРОКОВЫЕ ЛИТЕРАЛЫ:" + Символы.ПС +
	"   - Используйте двойные кавычки: ""ООО Ромашка""" + Символы.ПС +
	"   - НЕ используйте амперсанд перед литералами: НЕПРАВИЛЬНО &""Сидоров"", ПРАВИЛЬНО ""Сидоров""" + Символы.ПС +
	"   - В JSON кавычки экранируются: ""query"": ""... ГДЕ Наименование = \""ООО Ромашка\""""" + Символы.ПС + Символы.ПС +
	"2. ЗАПРЕЩЕННЫЕ ФУНКЦИИ В ЗАПРОСАХ:" + Символы.ПС +
	"   - СтрНайти() - НЕ поддерживается" + Символы.ПС +
	"   - СтрНачинаетсяС() - НЕ поддерживается" + Символы.ПС +
	"   - Подобие() - НЕ поддерживается" + Символы.ПС +
	"   - НАЙТИ() - НЕ поддерживается" + Символы.ПС +
	"   Вместо них используйте ПОДОБНО: ГДЕ Наименование ПОДОБНО ""%Сидоров%""" + Символы.ПС + Символы.ПС +
	"3. ИМЕНА ПОЛЕЙ:" + Символы.ПС +
	"   - Используйте системные имена (System names), а не синонимы" + Символы.ПС +
	"   - Пример: Номенклатура.Наименование (не Номенклатура.Название)" + Символы.ПС +
	"   - Для получения списка полей используйте GetObjectFields" + Символы.ПС + Символы.ПС +
	"4. ТИПЫ ДАННЫХ:" + Символы.ПС +
	"   - Булево: ИСТИНА, ЛОЖЬ" + Символы.ПС +
	"   - NULL: ЕСТЬ NULL, НЕ ЕСТЬ NULL" + Символы.ПС +
	"   - Даты: ДАТАВРЕМЯ(ГГГГ, ММ, ДД, ЧЧ, ММ, СС)" + Символы.ПС + Символы.ПС +
	"5. ОПЕРАТОРЫ:" + Символы.ПС +
	"   - И, ИЛИ, НЕ - логические операторы" + Символы.ПС +
	"   - =, <>, >, <, >=, <= - операторы сравнения" + Символы.ПС +
	"   - ПОДОБНО - для поиска по шаблону" + Символы.ПС +
	"   - В, НЕ В - для проверки вхождения" + Символы.ПС +
	"   - МЕЖДУ ... И ... - для диапазонов" + Символы.ПС + Символы.ПС +
	"6. АГРЕГАТНЫЕ ФУНКЦИИ:" + Символы.ПС +
	"   - Используются только с СГРУППИРОВАТЬ ПО" + Символы.ПС +
	"   - Все неагрегированные поля должны быть в СГРУППИРОВАТЬ ПО" + Символы.ПС + Символы.ПС +
	"7. ПОДЗАПРОСЫ:" + Символы.ПС +
	"   - Могут использоваться в условиях В, НЕ В, СУЩЕСТВУЕТ, НЕ СУЩЕСТВУЕТ" + Символы.ПС +
	"   - Могут использоваться в списке полей" + Символы.ПС + Символы.ПС +
	"8. ВИРТУАЛЬНЫЕ ТАБЛИЦЫ:" + Символы.ПС +
	"   - Используются только для регистров" + Символы.ПС +
	"   - Требуют параметры (например, &МоментВремени)" + Символы.ПС + Символы.ПС +
	"9. ПРОИЗВОДИТЕЛЬНОСТЬ:" + Символы.ПС +
	"   - Используйте индексы (поля в условиях ГДЕ)" + Символы.ПС +
	"   - Избегайте функций в условиях ГДЕ" + Символы.ПС +
	"   - Используйте ОГРАНИЧИТЬ для больших выборок" + Символы.ПС + Символы.ПС +
	"10. ПРИМЕРЫ ПРАВИЛЬНОГО СИНТАКСИСА:" + Символы.ПС +
	"    ВЫБРАТЬ" + Символы.ПС +
	"        Номенклатура.Наименование," + Символы.ПС +
	"        Номенклатура.Цена" + Символы.ПС +
	"    ИЗ" + Символы.ПС +
	"        Справочник.Номенклатура КАК Номенклатура" + Символы.ПС +
	"    ГДЕ" + Символы.ПС +
	"        Номенклатура.ПометкаУдаления = ЛОЖЬ" + Символы.ПС +
	"        И Номенклатура.Наименование ПОДОБНО ""%ООО%""" + Символы.ПС +
	"    УПОРЯДОЧИТЬ ПО" + Символы.ПС +
	"        Номенклатура.Цена УБЫВ";
	
	Возврат Справка;
	
КонецФункции

// Получает справку по конкретной функции (для быстрого поиска)
//
// Параметры:
//  ИмяФункции - Строка - имя функции (например, "ДОБАВИТЬКДАТЕ")
//
// Возвращаемое значение:
//  Строка - описание функции или пустая строка, если не найдена
//
Функция ПолучитьСправкуПоФункции(ИмяФункции) Экспорт
	
	ИмяФункцииВерхнийРегистр = ВРег(ИмяФункции);
	
	// Функции работы с датами
	Если ИмяФункцииВерхнийРегистр = "ДОБАВИТЬКДАТЕ" Тогда
		Возврат "ДОБАВИТЬКДАТЕ(<Дата>, <ЕдиницаИзмерения>, <Количество>)" + Символы.ПС +
		"Прибавляет или вычитает указанное количество единиц времени к дате." + Символы.ПС +
		"Параметры:" + Символы.ПС +
		"- Дата: начальная дата" + Символы.ПС +
		"- ЕдиницаИзмерения: СЕКУНДА, МИНУТА, ЧАС, ДЕНЬ, НЕДЕЛЯ, МЕСЯЦ, КВАРТАЛ, ГОД" + Символы.ПС +
		"- Количество: положительное (прибавить) или отрицательное (вычесть)" + Символы.ПС +
		"Пример: ДОБАВИТЬКДАТЕ(ТекущаяДата(), ДЕНЬ, 10)";
	ИначеЕсли ИмяФункцииВерхнийРегистр = "ТЕКУЩАЯДАТА" Тогда
		Возврат "ТекущаяДата() - возвращает текущую дату и время";
	ИначеЕсли ИмяФункцииВерхнийРегистр = "ДАТАВРЕМЯ" Тогда
		Возврат "ДАТАВРЕМЯ(<Год>, <Месяц>, <День>[, <Час>, <Минута>, <Секунда>]) - создает дату из компонентов";
	ИначеЕсли ИмяФункцииВерхнийРегистр = "ПОДОБНО" Тогда
		Возврат "ПОДОБНО - оператор сравнения (LIKE), а не функция." + Символы.ПС +
		"Синтаксис: <Поле> ПОДОБНО ""<Шаблон>""" + Символы.ПС +
		"Символы шаблона: % (любые символы), _ (один символ)" + Символы.ПС +
		"Пример: ГДЕ Наименование ПОДОБНО ""%ООО%""";
	ИначеЕсли ИмяФункцииВерхнийРегистр = "ВЫРАЗИТЬ" Тогда
		Возврат "ВЫРАЗИТЬ(<Значение> КАК <Тип>) - преобразует значение к указанному типу." + Символы.ПС +
		"Пример: ВЫРАЗИТЬ(Сумма КАК Число(15, 2))";
	ИначеЕсли ИмяФункцииВерхнийРегистр = "СУММА" Тогда
		Возврат "СУММА(<Поле>) - агрегатная функция, возвращает сумму значений. Используется с СГРУППИРОВАТЬ ПО";
	ИначеЕсли ИмяФункцииВерхнийРегистр = "КОЛИЧЕСТВО" Тогда
		Возврат "КОЛИЧЕСТВО(<Поле>) - агрегатная функция, возвращает количество записей. Можно использовать КОЛИЧЕСТВО(*)";
	ИначеЕсли ИмяФункцииВерхнийРегистр = "СРЕДНЕЕ" Тогда
		Возврат "СРЕДНЕЕ(<Поле>) - агрегатная функция, возвращает среднее значение";
	ИначеЕсли ИмяФункцииВерхнийРегистр = "МАКСИМУМ" Тогда
		Возврат "МАКСИМУМ(<Поле>) - агрегатная функция, возвращает максимальное значение";
	ИначеЕсли ИмяФункцииВерхнийРегистр = "МИНИМУМ" Тогда
		Возврат "МИНИМУМ(<Поле>) - агрегатная функция, возвращает минимальное значение";
	КонецЕсли;
	
	Возврат "";
	
КонецФункции

#КонецОбласти
