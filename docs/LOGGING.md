# Логирование

Агент ведёт логи для отладки и аудита. Поддерживаются два канала: регистр сведений и файл.

## Регистр сведений ИИА_Логи

Все записи лога сохраняются в регистр сведений **ИИА_Логи**:

- **Точка записи:** `ИИА_Сервер.ДобавитьЗаписьВЛогДиалога(СсылкаДиалога, ЗаписьЛога, Роль, CallId, УИДЗаписи)`
- **Измерение:** Диалог (ссылка на ИИА_Диалоги)
- **Ресурсы:** УИД, Роль, CallId, Дата, Лог (текст записи)

Записи содержат: сообщения пользователя, вызовы ИИ, результаты DSL, системные события. Подавление дубликатов для `dsl_system_result`.

## Файл для отладки

При включённом режиме отладки лог дополнительно пишется в файл:

- **Условие:** в настройках пользователя (регистр `ИИА_НастройкиПользователей`) заданы:
  - `РежимОтладки = Истина`
  - `ПутьКЛогуОтладки` — путь к файлу
- **Запись:** `ДобавитьЗаписьВЛогДиалога` дописывает строку в файл (UTF-8, в конец)
- **Очистка:** при запуске оркестратора вызывается `ОчиститьФайлЛогаОтладки()` — файл перезаписывается (очищается)

Файловый лог удобен для отладки без доступа к регистру, ротация не выполняется — при каждом новом запуске оркестратора файл очищается.
